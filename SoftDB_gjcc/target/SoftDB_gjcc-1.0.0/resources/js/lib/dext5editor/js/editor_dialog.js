var G_IMAGE_ALLOW_EXT=["jpg","jpeg","png","gif","bmp"],G_dragDropFileObj=null,LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID),LayerWin=LayerFrame.contentWindow,LayerDoc=LayerWin.document;
function dext_setting(){var a=document.getElementById("grid_color").style.backgroundColor,b=document.getElementById("grid_color_name").innerHTML,c=document.getElementById("lang").value,e=document.getElementById("grid_spans").value,d=document.getElementsByName("grid_form")[0].checked?"line":"dot",f=document.getElementById("page_title").value,g=document.getElementById("encoding").value,h=document.getElementById("doctype").value,l=document.getElementById("xhtml").checked?document.getElementById("xhtml").value:
"",k=document.getElementById("check_auto_save").checked,m=document.getElementById("input_auto_save").value,m="none"!=document.getElementById("div_auto_save").style.display?k?""!=m&&"0"!=m?"1,"+document.getElementById("input_auto_save").value:"2":"2":"0",k=LayerWin._dext_editor._config.accessibility;if("1"==k)""==f&&alert(LayerWin.dext5_lang.msg.alert_page_title_access1);else if("2"==k&&""==f){alert(LayerWin.dext5_lang.msg.alert_page_title_access2);document.getElementById("page_title").focus();return}k=
document.getElementById("ruler_px").value;dext_json={grid_color:a,grid_color_nm:b,grid_spans:e,grid_form:d,page_title:f,encoding:g,lang:c,doctype:h,xhtml:l,auto_save:m,ruler_px:k};LayerWin.event_dext_setting(dext_json,window.frameElement.parentNode.parentNode)}
function dext_horizontal_line(a,b){var c;if(!a){c=document.getElementById("width_1").value;var e=document.getElementById("height").value,d=document.getElementById("align").value,f=document.getElementById("hr_color").style.borderTopColor;c={width:c,height:e,align:d,color:f}}LayerWin.event_dext_horizontal_line(c,a,b,window.frameElement.parentNode.parentNode)}
function loading_image_show(a){var b=document.getElementById("dext_loading"),c="";0==a?(c="none",document.body.style.cursor="default"):document.body.style.cursor="wait";b&&(b.style.display=c);"1"==LayerWin._dext_editor._config.uploadUseHTML5&&a&&b&&b.childNodes&&(b.childNodes[1].nodeValue=" Uploading... ")}function web_url_remove_char(a){a=a.replace(/(\r\n|\r|\n)/gm,"");a=a.replace(/ /g,"");a=a.replace(/&#13;/g,"");a=a.replace(/&#10;/g,"");return a=a.replace(/&#32;/g,"")}
function dext_upload_image(){var a=document.dext_upload_form,b;b=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var c=document.getElementById("img_web_url"),e=document.getElementById("link_url"),d=LayerWin.getElementsByClass("EdiTor_Popup_contents",document),f=/^\s\s*$/;if(!f.exec(e.value)&&""!=e.value){var f=new RegExp(/^(http|ftp|https|news)/),
g=f.test(e.value);if("http://"==e.value)e.value="";else if(g&&!DEXTTOP.DEXT5.util.checkUrl(e.value)){alert(LayerWin.dext5_lang.msg.alert_url);d[0].className="EdiTor_Popup_contents none";d[1].className="EdiTor_Popup_contents view";LayerWin.lastFocus(e);return}}if(document.getElementsByName("InputFlag")[0].checked)if(e=b.value,0<e.lastIndexOf(".")){c=LayerWin._dext_editor._config.accessibility;d=document.getElementById("img_alt").value;if("1"==c)""==d&&alert(LayerWin.dext5_lang.msg.alert_image_alt_access1);
else if("2"==c&&""==d){alert(LayerWin.dext5_lang.msg.alert_image_alt_access2);document.getElementById("img_alt").focus();return}for(var c=e.substring(e.lastIndexOf(".")+1).toLowerCase(),d=!1,f=LayerWin._dext_editor._config.allowImageFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(c==f[l]){d=!0;break}if("base64"==LayerWin._dext_editor._config.uploadMethod){b="1"==LayerWin._dext_editor._config.uploadUseHTML5?G_dragDropFileObj[0]:b.files[0];var k=new FileReader;
k.onload=function(){var a=k.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_dext_image_upload_completed(a)};b.src=a;k=void 0};k.readAsDataURL(b)}else 1==d?(d=LayerWin._dext_editor._config.image_convert_width,f=LayerWin._dext_editor._config.image_convert_height,"1"==LayerWin._dext_editor._config.imageAutoConvert&&(f=d="0"),"1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=
DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(d),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(f),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=
DEXTTOP.DEXT5.util.makeEncryptParam(e.substring(e.lastIndexOf("\\")+1)))):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=
LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=d,document.getElementById("image_convert_height").value=f,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=e.substring(e.lastIndexOf("\\")+1))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,
"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),
a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",document.getElementById("image_convert_height").value),document.getElementById("originalfilename").value&&
a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},event_dext_image_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(g)}else""==e?alert(LayerWin.dext5_lang.msg.alert_no_file):
alert(LayerWin.dext5_lang.msg.alert_exec);else e=c.value,f=new RegExp(/^(http|ftp|https|news)/),g=f.test(e),f=/^\s\s*$/,""==e||f.exec(e)||g&&!DEXTTOP.DEXT5.util.checkUrl(e)?(alert(LayerWin.dext5_lang.msg.alert_url),c.focus()):event_dext_image_upload_completed(e)}
function event_dext_image_link(){var a=document.getElementById("img_web_url").value,b=document.getElementById("img_width").value,c=document.getElementById("img_height").value,e=document.getElementById("img_alt").value,d=document.getElementById("img_title").value,f=document.getElementById("img_v_space").value,g=document.getElementById("img_h_space").value,h=document.getElementById("img_align"),h=h.options[h.selectedIndex].value,l="";document.getElementById("img_border")&&(l=document.getElementById("img_border").value);
var k=document.getElementById("link_url").value,m=document.getElementById("link_title").value,n=document.getElementById("link_target").value;LayerWin.event_dext_image_upload("","","","0",a,0,0,e,"",{srcURL:a,width:b,height:c,title:d,alt:e,vspace:f,hspace:g,align:h,border:l,linkurl:k,linktitle:m,linktarget:n},window.frameElement.parentNode.parentNode)}
function event_dext_image_upload_completed(a){var b=!1;document.getElementsByName("InputFlag")[1]&&(b=document.getElementsByName("InputFlag")[1].checked);"base64"!=LayerWin._dext_editor._config.uploadMethod&&a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if("CCODE_001"==LayerWin._dext_editor._config.custom_code){var c=a=web_url_remove_char(a),e=document.getElementById("img_alt").value,d=document.getElementById("img_title").value,f=document.getElementById("img_id").value,
g=document.getElementById("img_class").value,h=document.getElementById("img_v_space").value,l=document.getElementById("img_h_space").value,k=document.getElementById("img_align"),k=k.options[k.selectedIndex].value,m="";document.getElementById("img_border")&&(m=document.getElementById("img_border").value);var n=document.getElementById("img_width").value,p=document.getElementById("img_height").value,v=document.getElementById("link_url").value,z=document.getElementById("link_title").value,x=document.getElementById("link_target").value,
w="",A="",B="",y="";document.getElementById("line_style")&&(w=document.getElementById("line_style").style.borderTop,"none"!=w&&(A=document.getElementById("line_kind").value,B=document.getElementById("line_color").style.borderTopColor,y=document.getElementById("line_thickness").value));a={srcURL:a,width:n,height:p,title:d,id:f,className:g,alt:e,vspace:h,hspace:l,align:k,border:m,linkurl:v,linktitle:z,linktarget:x,continueInsert:D,input_url_checked:b,borderStyle:w,borderKind:A,borderColor:B,borderThickness:y}}else{n=
document.getElementById("img_width").value;p=document.getElementById("img_height").value;if(!b){var q=0,r=0;if(null!=a&&void 0!=a){try{c=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a),null!=c&&void 0!=c&&(a=c)}catch(H){}h=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(h=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<h.length&&(a=h[0]));var t=a.split("?");2==t.length&&(a=t[0],t=t[1].split("^"),2==t.length?(q=t[0],r=t[1]):
3==t.length&&(q=t[0],r=t[1],a+="?"+t[2]));if(elemModify&&"img"==elemModify.tagName.toLowerCase()){"[FAIL]"==a.substring(0,6)?(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",elemModify.setAttribute("alt",a.substring(6,a.length).replace(/"/g,"'"))):elemModify.src=a;"function"==typeof G_UploadCompleteCallBackFn&&G_UploadCompleteCallBackFn();return}t=!1;document.getElementById("original_size")&&(t=document.getElementById("original_size").checked);if(!t)if("1"==LayerWin._dext_editor._config.imageAutoConvert){var t=
LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_width),C=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_height),u=!1,c=!1,q=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(q),r=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(r);0!=t&&0==C?q>t&&(u=!0):0==t&&0!=C?r>C&&(c=!0):(e=1*t/q,D=1*C/r,e<D?1>e&&(u=!0):1>D&&(c=!0));u?(u=t/q,q=t,r=DEXTTOP.DEXT5.util.parseIntOr0(u*r)):c&&(u=C/r,r=C,q=DEXTTOP.DEXT5.util.parseIntOr0(u*q))}else"1"==LayerWin._dext_editor._config.image_auto_fit&&
q>LayerWin._dext_editor._defaultWidth?(u=LayerWin._dext_editor._defaultWidth/q,q=LayerWin._dext_editor._defaultWidth,r*=u):"2"==LayerWin._dext_editor._config.image_auto_fit&&(q>LayerWin._dext_editor._defaultWidth||r>LayerWin._dext_editor._defaultHeight)&&(n=LayerWin._dext_editor._defaultWidth,p=LayerWin._dext_editor._defaultHeight,t=p/n,C=r/q,C>t?r>p?n=Math.round(q*p/r):(n=q,p=r):C<t?q>n?p=Math.round(r*n/q):(n=q,p=r):(n=q,p=r))}0==n.length&&0<q&&(n=parseInt(q),p=parseInt(r));loading_image_show(!1);
if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a}))return}catch(I){}if(!b&&"/"!=LayerWin._dext_editor._config.serverDomain&&(4>a.length||"http"!=a.substring(0,4).toLowerCase())&&"[FAIL]"!=a.substring(0,6)&&"base64"!=LayerWin._dext_editor._config.uploadMethod){confirm(LayerWin.dext5_lang.msg.uploadFailed)&&alert(a);return}a=web_url_remove_char(a)}q=document.getElementById("savefilename").value;t=r="";C="0";c=a;
e=document.getElementById("img_alt").value;d=document.getElementById("img_title").value;g=f="";try{f=document.getElementById("img_id").value,g=document.getElementById("img_class").value}catch(J){}var l=document.getElementById("img_margin_left").value,F=document.getElementById("img_margin_right").value,E=document.getElementById("img_margin_top").value,G=document.getElementById("img_margin_bottom").value,k=document.getElementById("img_align"),k=k.options[k.selectedIndex].value,m="";document.getElementById("img_border")&&
(m=document.getElementById("img_border").value);var D=!1;document.getElementById("continue_insert")&&(D=document.getElementById("continue_insert").checked);v=document.getElementById("link_url").value;z=document.getElementById("link_title").value;x=document.getElementById("link_target").value;y=B=A=w="";document.getElementById("line_style")&&(w=document.getElementById("line_style").style.borderTopStyle,"none"!=w&&(A=document.getElementById("line_kind").value,B=document.getElementById("line_color").style.borderTopColor,
y=document.getElementById("line_thickness").value));a={srcURL:a,width:n,height:p,title:d,id:f,className:g,alt:e,margin_left:l,margin_right:F,margin_top:E,margin_bottom:G,align:k,border:m,linkurl:v,linktitle:z,linktarget:x,continueInsert:D,input_url_checked:b,img_attr_info_arr:h,input_url_checked:b,borderStyle:w,borderKind:A,borderColor:B,borderThickness:y};u=""+("<img style='width:"+n+"px; height:"+p+"px;");0<E.length&&!isNaN(E)&&(u+=" margin-top:"+E+"px;");0<F.length&&!isNaN(F)&&(u+=" margin-right:"+
F+"px;");0<G.length&&!isNaN(G)&&(u+=" margin-bottom:"+G+"px;");0<l.length&&!isNaN(l)&&(u+=" margin-left:"+l+"px;");u=u+" ' "+(" src='"+c+"'");u+=" alt='"+e+"'";0<k.length&&(u+=" align='"+k+"'");0<m.length&&!isNaN(m)&&(u+=" border='"+m+"'");u+=" />"}LayerWin.event_dext_image_upload(q,r,t,C,c,n,p,e,u,a,window.frameElement.parentNode.parentNode)}
function dext_upload_flash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value,b=document.createElement("div");b.innerHTML=a;b=b.getElementsByTagName("EMBED")[0];if(null==b)alert(LayerWin.dext5_lang.flash.invalid_tag);else{var a=null,c=b.getAttribute("scale")?b.getAttribute("scale"):"",e=b.getAttribute("allowScriptAccess")?b.getAttribute("allowScriptAccess"):"",d=b.getAttribute("quality")?b.getAttribute("quality"):"",f=b.getAttribute("align")?
b.getAttribute("align"):"",g,h,l,k;g=null==b.getAttribute("menu")||void 0==b.getAttribute("menu")?!0:0==b.getAttribute("menu")||"false"==b.getAttribute("menu")?!1:!0;h=null==b.getAttribute("play")||void 0==b.getAttribute("play")?!0:0==b.getAttribute("play")||"false"==b.getAttribute("play")?!1:!0;l=null==b.getAttribute("loop")||void 0==b.getAttribute("loop")?!0:0==b.getAttribute("loop")||"false"==b.getAttribute("loop")?!1:!0;null==b.getAttribute("allowFullScreen")||void 0==b.getAttribute("allowFullScreen")?
k=!0:0==b.getAttribute("allowFullScreen")||"false"==b.getAttribute("allowFullScreen")?_allowFullScreenu=!1:k=!0;var m=b.getAttribute("flashvars")?b.getAttribute("flashvars"):"";"embed"==b.tagName.toLowerCase()&&(a={type:"flash",src:b.src,width:0==LayerWin.parseIntOr0(b.style.width)?LayerWin.parseIntOr0(b.width):LayerWin.parseIntOr0(b.style.width),height:0==LayerWin.parseIntOr0(b.style.height)?LayerWin.parseIntOr0(b.height):LayerWin.parseIntOr0(b.style.height),hspace:LayerWin.parseIntOr0(b.getAttribute("hspace")),
vspace:LayerWin.parseIntOr0(b.getAttribute("vspace")),scale:c,allowScriptAccess:e,quality:d,align:f,menu:g,play:h,loop:l,allowFullScreen:k,flashvars:m},k=LayerWin.getLinkMediaType(a.src),0<k.length&&(a.type=k,a.type2="flash"));LayerWin.event_dext_media_upload("","","","","","",a,window.frameElement.parentNode.parentNode)}}else if(a=document.dext_upload_form,k="",k="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b=document.getElementById("web_url"),
document.getElementsByName("InputFlag")[0].checked)if(c=k.value,0<c.lastIndexOf(".")){b=c.substring(c.lastIndexOf(".")+1).toLowerCase();c=!1;e=LayerWin._dext_editor._config.allowFlashFileType;d=e.toString()+LayerWin.dext5_lang.msg.alert_exec_tail;for(f=0;f<e.length;f++)if(b==e[f]){c=!0;break}1==c?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(b),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*
Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule)):
(document.getElementById("savefileext").value=b,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),
loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),
a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"flash",handlerUrl:LayerWin._dext_editor._config.post_url,
fileID:k.id,fileObj:G_dragDropFileObj,formData:a},event_dext_flash_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(d)}else""==c?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else c=b.value,k=(new RegExp(/^(http|ftp|https|news)/)).test(c),a=/^\s\s*$/,""==c||a.exec(c)||k&&!DEXTTOP.DEXT5.util.checkUrl(c)?(alert(LayerWin.dext5_lang.msg.alert_url),b.focus()):event_dext_flash_upload_completed(c)}
function dext_upload_flash_byFlash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value;DEXTTOP.event_dext_media_upload("","","","","",a)}else{a=document.dext_upload_form;document.getElementById(file_field_id);var b=document.getElementById("web_url"),b=document.getElementsByName("InputFlag")[0].checked?"dext.swf":b.value;if(0<b.lastIndexOf(".")){for(var c=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowFlashFileType,
f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=0;g<d.length;g++)if(c==d[g]){e=!0;break}1==e?document.getElementsByName("InputFlag")[0].checked?(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=
LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,a.action=document.getElementById("upload_url").value,document.getElementById("dext_flash_uploader").dext_upload()):event_dext_flash_upload_completed(b):alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}}
function event_dext_flash_upload_completed(a){a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,
{type:"flashUpload",message:a}))return}catch(e){}if("/"!=LayerWin._dext_editor._config.serverDomain&&(4>a.length||"http"!=a.substring(0,4).toLowerCase())){confirm(LayerWin.dext5_lang.msg.uploadFailed)&&alert(a);return}}var b=document.getElementById("savefilename").value,d=document.getElementById("flash_width").value,f=document.getElementById("flash_height").value,g=document.getElementById("flash_margin_left").value,h=document.getElementById("flash_margin_right").value,l=document.getElementById("flash_margin_top").value,
k=document.getElementById("flash_margin_bottom").value,m=document.getElementById("flash_scale").value,n=document.getElementById("flash_allowScriptAccess").value,p=document.getElementById("flash_quality").value,v=document.getElementById("flash_menu").checked,z=document.getElementById("flash_play").checked,x=document.getElementById("flash_loop").checked,w=document.getElementById("flash_allowFullScreen").checked,A=0==LayerWin.parseIntOr0(d)?"300":d,B=0==LayerWin.parseIntOr0(f)?"300":f;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,
a);A={type:"flash",src:a,width:A,height:B,margin_left:g,margin_right:h,margin_top:l,margin_bottom:k,scale:m,allowScriptAccess:n,quality:p,menu:v,play:z,loop:x,allowFullScreen:w};d=""+("<embed style='width:"+d+"px; height:"+f+"px; ");""!=g&&(d+="margin-left:"+g+"; ");""!=h&&(d+="margin-right:"+h+"; ");""!=l&&(d+="margin-top:"+l+"; ");""!=k&&(d+="margin-bottom:"+k+"; ");d=d+"'"+("src='"+a+"'");""!=m&&(d+="scale='"+m+"'");""!=n&&(d+="allowScriptAccess='"+n+"'");""!=p&&(d+="quality='"+p+"'");0==v&&(d+=
"menu='false'");0==z&&(d+="play='false'");0==x&&(d+="loop='false'");0==w&&(d+="allowFullScreen='false'");d+='wmode="transparent"';d+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";LayerWin.event_dext_media_upload(b,"","","",a,d,A,window.frameElement.parentNode.parentNode)}
function dext_upload_media(){var a=document.dext_upload_form,b="",b="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),c,e=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(c=b.value,0<c.lastIndexOf(".")){c=c.substring(c.lastIndexOf(".")+1).toLowerCase();for(var e=!1,d=LayerWin._dext_editor._config.allowMediaFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,
h=0;h<g;h++)if(c==d[h]){e=!0;break}1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=
LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),
a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),
a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},event_dext_media_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(f)}else""==c?alert(LayerWin.dext5_lang.msg.alert_no_file):
alert(LayerWin.dext5_lang.msg.alert_exec);else c=e.value,b=new RegExp(/(http|https|mms):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/),a=(new RegExp(/^(http|https|mms)/)).test(c),d=/^\s\s*$/,""==c||d.exec(c)||a&&!b.test(c)?(alert(LayerWin.dext5_lang.msg.alert_url),e.focus()):event_dext_media_upload_completed(c)}
function event_dext_flash_flash_upload_completed(a,b,c){LayerWin.event_dext_media_upload(a,"","","0",b,c,{type:"flash",src:b,width:300,height:300,hspace:"",vspace:"",scale:"",allowScriptAccess:"",quality:"",align:"",menu:"",play:"",loop:"",allowFullScreen:""},window.frameElement.parentNode.parentNode)}
function event_dext_flash_media_upload_completed(a,b,c){LayerWin.event_dext_media_upload(a,"","","0",b,c,{type:"media",src:b,width:300,height:300,autoStart:!1,playCount:!1,showTracker:!1,showStatusBar:!1,showControls:!1,showAudioControls:!1,showDisplay:!1,showPositionControls:!1},window.frameElement.parentNode.parentNode)}
function event_dext_media_upload_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==
DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a}))return}catch(e){}if("/"!=LayerWin._dext_editor._config.serverDomain&&(4>a.length||"http"!=a.substring(0,4).toLowerCase())){confirm(LayerWin.dext5_lang.msg.uploadFailed)&&alert(a);return}}var b=document.getElementById("savefilename").value,d=document.getElementById("media_width").value,f=document.getElementById("media_height").value,g=0==LayerWin.parseIntOr0(d)?"300":d,h=0==LayerWin.parseIntOr0(f)?"300":
f;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);g={type:"media",src:a,width:g,height:h,autoStart:document.getElementById("cb_autostart").checked,playCount:document.getElementById("cb_loop").checked,showTracker:document.getElementById("cb_tracker").checked,showStatusBar:document.getElementById("cb_status").checked,showControls:document.getElementById("cb_controls").checked,showAudioControls:document.getElementById("cb_volumn").checked,showDisplay:document.getElementById("cb_display").checked,
showPositionControls:document.getElementById("cb_position").checked};h="";d=""+("<embed style='width:"+d+"px; height:"+f+"px;' ")+" type=application/x-mplayer2 ";d+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ";d+=" src='"+a+"'";h=1==document.getElementById("cb_autostart").checked?"1":"0";d+=" AutoStart='"+h+"'";h=1==document.getElementById("cb_loop").checked?"1":"0";d+=" loop='"+h+"'";h=1==document.getElementById("cb_tracker").checked?"1":"0";d+=" ShowTracker='"+h+"'";
h=1==document.getElementById("cb_status").checked?"1":"0";d+=" ShowStatusBar='"+h+"'";h=1==document.getElementById("cb_controls").checked?"1":"0";d+=" ShowControls='"+h+"'";h=1==document.getElementById("cb_volumn").checked?"1":"0";d+=" ShowAudioControls='"+h+"'";h=1==document.getElementById("cb_display").checked?"1":"0";d+=" ShowDisplay='"+h+"'";h=1==document.getElementById("cb_position").checked?"1":"0";d+=" ShowPositionControls='"+h+"'";d+=" />";LayerWin.event_dext_media_upload(b,"","","0",a,d,
g,window.frameElement.parentNode.parentNode)}
function dext_detail_table_upload_image(){var a=document.getElementById("tab_value").value,b=LayerWin._dext_editor._config.accessibility,c=document.getElementById("table_caption").value,e=document.getElementById("table_summary").value,d="N";1==document.getElementById("scope").checked&&(d="Y");var f="N";1==document.getElementById("t_scope").checked&&(f="Y");var g=document.getElementById("title_cell").value;if("1"==b)"3"!=a&&"4"!=a?(""==c&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),""==
e&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),"1"!=g&&"N"==d&&alert(LayerWin.dext5_lang.msg.alert_scope_access1)):"3"==a&&"N"==f&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==b)if("3"!=a&&"4"!=a){if(""==c){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if(""==e){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();return}if("1"!=g&&"N"==d){alert(LayerWin.dext5_lang.msg.alert_scope_access2);
document.getElementById("scope").focus();return}}else if("3"==a&&"N"==f){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("t_scope").focus();return}c=document.dext_upload_form;b="";b="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);e="";b&&(e=b.value);d=e.lastIndexOf(".");if("3"!=a&&"4"!=a&&0<d){for(var a=e.substring(e.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowImageFileType,
f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,h=0;h<g;h++)if(a==d[h]){e=!0;break}1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(a),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),
document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),
document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_height)):(document.getElementById("savefileext").value=a,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,
document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=
LayerWin._dext_editor._config.image_convert_height),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),
a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),
a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},event_dext_detail_table_completed)):(c.action=document.getElementById("upload_url").value,c.submit())):alert(f)}else""==e||"3"==a||"4"==
a?event_dext_detail_table_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_detail_table_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(null!=a&&void 0!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}b=a.split("?");2==b.length&&
(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a}))return}catch(e){}a=web_url_remove_char(a);var b=document.getElementById("tab_value").value,d=document.getElementById("width_line").value,f=document.getElementById("height_line").value,g=document.getElementById("width").value,h=document.getElementById("height").value,l="";1==document.getElementById("table_edge_reduce").checked?
l="Y":0==document.getElementById("table_edge_reduce").checked&&(l="N");var k=document.getElementById("range").value,m=document.getElementById("topcell1"),n=document.getElementById("topcell2"),p=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var v={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};v.outsideTop=m.style.borderTop;v.outsideLeft=m.style.borderLeft;v.outsideRight=n?n.style.borderRight:m.style.borderRight;v.outsideBottom=
p?p.style.borderBottom:m.style.borderBottom;p&&(v.insideRow=p.style.borderTop);n&&(v.insideCol=m.style.borderRight);var m=document.getElementById("cell_gap").value,n=document.getElementById("cell_inside_margin").value,p=document.getElementById("table_caption").value,z=document.getElementById("table_summary").value,x=document.getElementById("add").value,w=document.getElementById("repeat").value,A=document.getElementById("horizontal").value,B=document.getElementById("vertical").value,y=document.getElementById("background_color").style.backgroundColor,
q="N";1==document.getElementById("scope").checked&&(q="Y");var r=document.getElementById("title_cell").value,H=document.getElementById("t_width_line").value,t=document.getElementById("t_height_line").value,C=document.getElementById("t_width").value,u=document.getElementById("t_height").value,I="N";1==document.getElementById("t_scope").checked&&(I="Y");var J=document.getElementById("templet").value,F=LayerWin.parseIntOr0(document.getElementById("margin_left").value),E=document.getElementById("class_name").value,
G=document.getElementById("table_id").value;"none"==document.getElementById("class_name").style.display&&(E=null);var D=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(D=!0);var K=document.getElementById("custom_templet").value;LayerWin.event_dext_detail_table_insert(b,d,f,g,h,l,k,v,m,n,p,z,a,x,w,A,B,y,q,r,H,t,C,u,I,J,F,window.frameElement.parentNode.parentNode,E,G,D,K,gXmlData)}
function dext_table_property_upload_image(){var a=LayerWin._dext_editor._config.accessibility,b=document.getElementById("table_caption").value,c=document.getElementById("table_summary").value,e="N";1==document.getElementById("scope").checked&&(e="Y");var d=document.getElementById("title_cell").value;if("1"==a)""==b&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),""==c&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),"1"!=d&&"N"==e&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);
else if("2"==a){if(""==b){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if(""==c){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();return}if("1"!=d&&"N"==e){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}}b=document.dext_upload_form;a="";a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):
document.getElementById(file_field_id);c="";a&&(c=a.value);if(0<c.lastIndexOf(".")){for(var c=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowImageFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,h=0;h<g;h++)if(c==d[h]){e=!0;break}1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*
Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),
document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_height)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=
Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,
document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe","1"),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),
b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),
b.setItem("image_convert_format",document.getElementById("image_convert_format").value),b.setItem("image_convert_width",document.getElementById("image_convert_width").value),b.setItem("image_convert_height",document.getElementById("image_convert_height").value),b.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"p_table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:a.id,
fileObj:G_dragDropFileObj,formData:b},event_dext_table_property_completed)):(b.action=document.getElementById("upload_url").value,b.submit())):alert(f)}else""==c?event_dext_table_property_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_table_property_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=a&&null!=a&&void 0!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}b=
a.split("?");2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]));"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a)}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a}))return}catch(e){}a=web_url_remove_char(a);var b=document.getElementById("width").value,d=document.getElementById("height").value,f="";1==document.getElementById("table_edge_reduce").checked?
f="Y":0==document.getElementById("table_edge_reduce").checked&&(f="N");var g=document.getElementById("range").value,h=LayerWin.parseIntOr0(document.getElementById("margin_left").value),l=document.getElementById("topcell1"),k=document.getElementById("topcell2"),m=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var n={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};n.outsideTop=l.style.borderTop;n.outsideLeft=l.style.borderLeft;
n.outsideRight=k?k.style.borderRight:l.style.borderRight;n.outsideBottom=m?m.style.borderBottom:l.style.borderBottom;m&&(n.insideRow=m.style.borderTop);k&&(n.insideCol=l.style.borderRight);var l=document.getElementById("cell_gap").value,k=document.getElementById("cell_inside_margin").value,m=document.getElementById("table_caption").value,p=document.getElementById("table_summary").value,v=document.getElementById("prev_background_remove").value,z=document.getElementById("add").value,x=document.getElementById("repeat").value,
w=document.getElementById("horizontal").value,A=document.getElementById("vertical").value,B=document.getElementById("background_color").style.backgroundColor,y="N";1==document.getElementById("scope").checked&&(y="Y");var q=document.getElementById("title_cell").value,r=document.getElementById("table_id").value,H=document.getElementById("class_name").value;"none"==document.getElementById("class_name").style.display&&(H=null);var t=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&
(t=!0);LayerWin.event_dext_table_property(b,d,f,g,n,l,k,m,p,v,a,z,x,w,A,B,y,q,h,window.frameElement.parentNode.parentNode,H,r,t)}
function dext_cell_property_upload_image(){var a=LayerWin._dext_editor._config.accessibility,b="";if("Y"==document.getElementById("title_cell").value||"N"==document.getElementById("title_cell").value)b=document.getElementById("title_cell").value;var c="";if("row"==document.getElementById("scope").value||"col"==document.getElementById("scope").value)c="row";if("1"==a)"Y"==b&&""==c&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==a&&"Y"==b&&""==c){alert(LayerWin.dext5_lang.msg.alert_scope_access2);
document.getElementById("scope").focus();return}b=document.dext_upload_form;a="";a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);c="";a&&(c=a.value);if(0<c.lastIndexOf(".")){for(var c=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowImageFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,h=0;h<g;h++)if(c==d[h]){e=!0;break}1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_height)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=
LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?
(b=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe","1"),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),
b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("image_convert_format",document.getElementById("image_convert_format").value),b.setItem("image_convert_width",document.getElementById("image_convert_width").value),b.setItem("image_convert_height",document.getElementById("image_convert_height").value),b.setItem(LayerWin._dext_editor._config.userFieldID,
document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"cell_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:a.id,fileObj:G_dragDropFileObj,formData:b},event_dext_cell_property_completed)):(b.action=document.getElementById("upload_url").value,b.submit())):alert(f)}else""==c?event_dext_cell_property_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_cell_property_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}null!=a&&void 0!=a&&
(b=a.split("?"),2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2])),"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a}))return}catch(e){}a=web_url_remove_char(a);var b=document.getElementById("horizontal_align").value,d=document.getElementById("vertical_align").value,f="",f=document.getElementById("title_cell").value,
g="",g=document.getElementById("scope").value,h="",h=document.getElementById("nowrap").value,l=document.getElementById("topcell1"),k=document.getElementById("topcell2"),m=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var n={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};n.outsideTop=l.style.borderTop;n.outsideLeft=l.style.borderLeft;n.outsideRight=k?k.style.borderRight:l.style.borderRight;n.outsideBottom=m?m.style.borderBottom:
l.style.borderBottom;m&&(n.insideRow=m.style.borderTop);k&&(n.insideCol=l.style.borderRight);var l=document.getElementById("prev_background_remove").value,k=document.getElementById("add").value,m=document.getElementById("repeat").value,p=document.getElementById("horizontal").value,v=document.getElementById("vertical").value,z=document.getElementById("background_color").style.backgroundColor;document.getElementById("tab_value");var x=document.getElementById("class_name").value;"notapplicable"==k&&
(k=null);"notapplicable"==m&&(m=null);"notapplicable"==b&&(b=null);"notapplicable"==d&&(d=null);if("none"==document.getElementById("class_name").style.display||"notapplicable"==x)x=null;"notapplicable"==f&&(f=null);"notapplicable"==g&&(g=null);"notapplicable"==h&&(h=null);LayerWin.event_dext_cell_property(b,d,f,g,h,n,l,a,k,m,p,v,z,window.frameElement.parentNode.parentNode,x)}
function dext_dog_bg_img_upload_image(){var a=document.dext_upload_form,b="",b="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),c="";b&&(c=b.value);if(0<c.lastIndexOf(".")){for(var c=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowImageFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,h=0;h<g;h++)if(c==d[h]){e=!0;break}1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_height)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=
LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?
(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),
a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem(LayerWin._dext_editor._config.userFieldID,
document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"doc_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},event_dext_dog_bg_img_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(f)}else""==c?event_dext_dog_bg_img_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function dext_upload_video_media(){var a=document.dext_upload_form,b="",b="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),c,e=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(c=b.value,0<c.lastIndexOf(".")){c=c.substring(c.lastIndexOf(".")+1).toLowerCase();for(var e=!1,d=LayerWin._dext_editor._config.allowVideoFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,
h=0;h<g;h++)if(c==d[h]){e=!0;break}1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=
LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),
a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),
a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"video_media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},event_dext_video_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(f)}else""==c?alert(LayerWin.dext5_lang.msg.alert_no_file):
alert(LayerWin.dext5_lang.msg.alert_exec);else c=e.value,b=new RegExp(/(http|https|mms):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/),a=(new RegExp(/^(http|https|mms)/)).test(c),d=/^\s\s*$/,""==c||d.exec(c)||a&&!b.test(c)?(alert(LayerWin.dext5_lang.msg.alert_url),e.focus()):event_dext_video_upload_completed(c)}
function event_dext_video_upload_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==
DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a}))return}catch(e){}if("/"!=LayerWin._dext_editor._config.serverDomain&&(4>a.length||"http"!=a.substring(0,4).toLowerCase())){confirm(LayerWin.dext5_lang.msg.uploadFailed)&&alert(a);return}}var b=document.getElementById("savefilename").value,d=document.getElementById("media_width").value,f=document.getElementById("media_height").value,g=0==LayerWin.parseIntOr0(d)?"300":d,h=0==LayerWin.parseIntOr0(f)?"300":
f;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);g={type:"video_media",src:a,width:g,height:h,autoPlay:document.getElementById("cb_autostart").checked,loop:document.getElementById("cb_loop").checked,controls:document.getElementById("cb_controls").checked,muted:document.getElementById("cb_muted").checked};d=""+("<video style='width:"+d+"px; height:"+f+"px;'");1==g.autoPlay&&(d+=" autoplay=''");1==g.loop&&(d+=" loop=''");1==g.controls&&(d+=" controls=''");1==g.muted&&(d+=" muted=''");d=d+">"+("<source src='"+
g.src.slice(0,g.src.lastIndexOf("."))+".mp4' type='video/mp4' />");d+="<source src='"+g.src.slice(0,g.src.lastIndexOf("."))+".ogv' type='video/ogg' />";d+="<source src='"+g.src.slice(0,g.src.lastIndexOf("."))+".webm' type='video/webm' />";d+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800";d+="</video>";LayerWin.event_dext_media_upload(b,"","","0",a,d,g,window.frameElement.parentNode.parentNode)}
function event_dext_cell_border_completed(){var a=document.getElementById("edge_border").style.borderTop,b=document.getElementById("edge_border").style.borderLeft,c=document.getElementById("edge_border").style.borderRight,e=document.getElementById("edge_border").style.borderBottom;LayerWin.event_dext_cell_border(a,b,c,e,window.frameElement.parentNode.parentNode)}
function event_dext_dog_bg_img_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=a){try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}null!=a&&void 0!=a&&(b=
a.split("?"),2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2])),"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a}))return}catch(e){}a=web_url_remove_char(a);var b=document.getElementById("prev_background_remove").value,d=document.getElementById("add").value,f=document.getElementById("repeat").value,
g=document.getElementById("background_color").style.backgroundColor;LayerWin.event_dext_dog_bg_img_insert(b,a,d,f,g,window.frameElement.parentNode.parentNode)}
function event_dext_find_completed(){var a=document.getElementById("search_contents").value,b=document.getElementsByName("search_option")[0].checked,c=document.getElementsByName("search_option")[1].checked,e=document.getElementsByName("search_option")[2].checked,d;1==document.getElementsByName("search_direction")[0].checked?d=!1:1==document.getElementsByName("search_direction")[1].checked&&(d=!0);LayerWin.event_dext_find(a,b,c,e,d,window.frameElement.parentNode.parentNode)}
function event_dext_replace_completed(){var a=document.getElementById("search_contents").value,b=document.getElementById("replace_contents").value,c=document.getElementsByName("search_option")[0].checked,e=document.getElementsByName("search_option")[1].checked,d=document.getElementsByName("search_option")[2].checked,f;1==document.getElementsByName("search_direction")[0].checked?f=!1:1==document.getElementsByName("search_direction")[1].checked&&(f=!0);LayerWin.event_dext_replace(a,b,c,e,d,f,window.frameElement.parentNode.parentNode)}
function event_dext_all_replace_completed(){var a=document.getElementById("search_contents").value,b=document.getElementById("replace_contents").value,c=document.getElementsByName("search_option")[0].checked,e=document.getElementsByName("search_option")[1].checked,d=document.getElementsByName("search_option")[2].checked,f;1==document.getElementsByName("search_direction")[0].checked?f=!1:1==document.getElementsByName("search_direction")[1].checked&&(f=!0);LayerWin.event_dext_all_replace(a,b,c,e,d,
f,window.frameElement.parentNode.parentNode)}function event_dext_spellcheck_find_completed(a){LayerWin.event_dext_spellcheck_find(a)}function event_dext_spellcheck_replace_completed(){var a=document.getElementById("wrong_word").value,b=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_replace(a,b)}
function event_dext_spellcheck_all_replace_completed(){var a=document.getElementById("wrong_word").value,b=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_all_replace(a,b)}
function event_dext_capital_small_letter_completed(){1==document.getElementsByName("capital_small_letter")[0].checked?_capital_small_letter="LOWER":1==document.getElementsByName("capital_small_letter")[1].checked?_capital_small_letter="UPPER":1==document.getElementsByName("capital_small_letter")[2].checked&&(_capital_small_letter="FIRSTUPPER");LayerWin.event_dext_capital_small_letter(_capital_small_letter,window.frameElement.parentNode.parentNode)}
function event_dext_emoticon_completed(a,b,c,e){LayerWin.event_dext_emoticon_insert({srcURL:a,width:c,height:e,title:b,alt:b,margin_left:"",margin_right:"",margin_top:"",margin_bottom:"",align_obj:"",align:"",border:"0",linkurl:"",borderStyle:"",borderKind:"",borderColor:"",borderThickness:""},window.frameElement.parentNode.parentNode)}
function event_dext_insert_row_column_completed(){var a="",b="";1==document.getElementById("row").checked?(a="R",1==document.getElementById("up").checked?b="U":1==document.getElementById("down").checked&&(b="D")):1==document.getElementById("column").checked&&(a="C",1==document.getElementById("right").checked?b="R":1==document.getElementById("left").checked&&(b="L"));var c=document.getElementById("line_count").value;LayerWin.event_dext_insert_row_column(a,b,c,window.frameElement.parentNode.parentNode)}
function event_dext_row_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,b=document.getElementById("row_height").value,c=document.getElementById("horizontal_align").value,e=document.getElementById("vertical_align").value;LayerWin.event_dext_row_property(a,b,c,e,window.frameElement.parentNode.parentNode)}
function event_dext_column_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,b=document.getElementById("column_width").value,c=document.getElementById("horizontal_align").value,e=document.getElementById("vertical_align").value;LayerWin.event_dext_column_property(a,b,c,e,window.frameElement.parentNode.parentNode)}
function dext_create_iframe(){var a=document.getElementById("input_url").value,b=(new RegExp(/^(http|ftp|https|news)/)).test(a),c=/^\s\s*$/;if(""==a||c.exec(a)||b&&!DEXTTOP.DEXT5.util.checkUrl(a))alert(LayerWin.dext5_lang.msg.alert_url),setCursorPos(document.getElementById("input_url"),!0,!1);else{a=LayerWin._dext_editor._config.accessibility;b=document.getElementById("input_title").value;if("1"==a)""==b&&alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access1);else if("2"==a&&""==b){alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access2);
document.getElementById("input_title").focus();return}b=document.getElementById("input_width").value;a=0==LayerWin.parseIntOr0(b)?"300":b;b=document.getElementById("input_height").value;b=0==LayerWin.parseIntOr0(b)?"300":b;a={type:"iframe",src:document.getElementById("input_url").value,id:document.getElementById("input_id").value,name:document.getElementById("input_name").value,className:document.getElementById("input_class").value,title:document.getElementById("input_title").value,width:a,height:b,
align:document.getElementById("select_align").value,scrolling:document.getElementById("select_scroll").value,frameBorder:document.getElementById("input_border").checked};b=LayerWin.getLinkMediaType(a.src);0<b.length&&(a.type=b,a.type2="iframe");LayerWin.event_dext_create_iframe(a,window.frameElement.parentNode.parentNode)}}
function dext_create_hyperlink_image(){var a=document.dext_upload_form,b="",b="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),c;c=b.value;if(""==c)alert(LayerWin.dext5_lang.background_image.msg_file_select),setCursorPos(b,!0,!1);else if(0<c.lastIndexOf(".")){c=c.substring(c.lastIndexOf(".")+1).toLowerCase();for(var e=!1,d=LayerWin._dext_editor._config.allowImageFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,
g=d.length,h=0;h<g;h++)if(c==d[h]){e=!0;break}e?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_height)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=
LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?
(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),
a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem(LayerWin._dext_editor._config.userFieldID,
document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"hyperlink_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},dext_create_hyperlink)):(a.action=document.getElementById("upload_url").value,a.submit())):(alert(f),setCursorPos(b,!0,!1))}else alert(f),setCursorPos(b,!0,!1)}
function dext_create_hyperlink(a){if("hyperlink"==document.getElementById("select_category").value||0>"bookmark,image".indexOf(document.getElementById("select_category").value)){var b=document.getElementById("input_url").value,c=(new RegExp(/^(http|https|ftp|news)/)).test(b),e=/^\s\s*$/;if(""==b||e.exec(b)||c&&!DEXTTOP.DEXT5.util.checkUrl(b)){alert(LayerWin.dext5_lang.msg.alert_url);setCursorPos(document.getElementById("input_url"),!0,!1);return}}else if("bookmark"==document.getElementById("select_category").value&&
""==document.getElementById("select_bookmark").value){alert(LayerWin.dext5_lang.msg.alert_bookmark);setCursorPos(document.getElementById("select_bookmark"),!0,!1);return}b=LayerWin._dext_editor._config.accessibility;c=document.getElementById("input_text").value;if("1"==b)""==c&&alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access1);else if("2"==b&&""==c){alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access2);document.getElementById("input_text").focus();return}b=document.getElementById("select_category").value;
0>"bookmark,image".indexOf(document.getElementById("select_category").value)&&(b="hyperlink");b={type:b,url:document.getElementById("input_url").value,text:document.getElementById("input_text").value,title:document.getElementById("input_title").value,target:document.getElementById("select_target").value,bookname:document.getElementById("select_bookmark").value,id:document.getElementById("input_id").value,className:document.getElementById("input_class").value};if(null!=a&&void 0!=a){a=a.replace(/\r\n/g,
"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");try{var d=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=d&&void 0!=d&&(a=d)}catch(f){}if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a}))return}catch(g){}d=a.split("?");2==d.length&&(a=d[0],d=d[1].split("^"),3==d.length&&(img_real_width=d[0],img_real_height=d[1],a+="?"+d[2]));a&&"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,
a);if(elemModify){document.getElementById("input_url").value=a;set_modify_ok();return}b.url=a}LayerWin.event_dext_create_hyperlink(b,window.frameElement.parentNode.parentNode)}
function split_cell_ok(){var a=document.getElementById("input_row"),b=document.getElementById("input_column"),c=document.getElementsByName("radio_split")[0],e=document.getElementsByName("radio_split")[1];c.checked?b.value="0":e.checked&&(a.value="0");LayerWin.event_dext_split_cell(a.value,b.value,window.frameElement.parentNode.parentNode)}function symbol_ok(){var a=document.getElementById("input_output");LayerWin.event_dext_symbol(a.innerHTML,window.frameElement.parentNode.parentNode)}
function template_ok(){var a=document.getElementById("clicked_template").value,b=document.getElementById("template_print_header").value,c=document.getElementById("template_print_footer").value,a={url:a,print_header:b,print_footer:c};0==DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_template(a,window.frameElement.parentNode.parentNode):LayerWin.event_dext_template(a,window.frameElement.parentNode.parentNode)}
function dext_insert_link_media(){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var a="",b=document.getElementById("ta_media_tag").value,c=document.getElementById("ta_media_caption").value,b=b.replace(/\r\n/g,""),b=b.replace(/\n/g,""),b=b.replace(/\r/g,""),a=b.match(/(<[\s]*embed [^>]+>)/gi),b=b.match(/(<[\s]*iframe [^>]+>)/gi);if(a)a=a[0];else if(b)a=b[0];else{alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}if("1"==
LayerWin._dext_editor._config.allowLinkMediaCaption)if("1"==LayerWin._dext_editor._config.accessibility)""==c&&alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access1);else if("2"==LayerWin._dext_editor._config.accessibility&&""==c){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access2);document.getElementById("ta_media_caption").focus();return}LayerWin.event_dext_insert_link_media(a,c,window.frameElement.parentNode.parentNode)}}
function dext_modify_link_media(a){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var b="",c=document.getElementById("ta_media_tag").value,e=document.getElementById("ta_media_caption").value,c=c.replace(/\r\n/g,""),c=c.replace(/\n/g,""),c=c.replace(/\r/g,""),b=c.match(/(<[\s]*embed [^>]+>)/gi),c=c.match(/(<[\s]*iframe [^>]+>)/gi);if(b)b=b[0];else if(c)b=c[0];else{alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}LayerWin.event_dext_modify_link_media(b,
e,a,window.frameElement.parentNode.parentNode)}}function dext_insert_paste_dialog_html(){var a=document.getElementById("pasteArea").contentWindow.document.body.innerHTML;LayerWin.event_dext_insert_paste_dialog_html(a,window.frameElement.parentNode.parentNode)}
function dext_insert_input_text(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertReadonly:!1,insertType:"text",insertSize:"",insertMaxlength:"",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth="0"==document.getElementById("input_width").value?"":document.getElementById("input_width").value;a.insertHeight="0"==document.getElementById("input_height").value?"":document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertSize="0"==
document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertMaxlength="0"==document.getElementById("input_maxtext").value?"":document.getElementById("input_maxtext").value;for(var b=document.getElementsByName("input_type"),c=b.length,e=0;e<c;e++)if(1==b[e].checked){a.insertType=b[e].value;break}for(var b=document.getElementById("event_table"),c=b.childNodes.length,e=0;e<c;e++){var d=b.childNodes[e].getElementsByTagName("span");a.insertEventNameArr.push(d[0].innerHTML);
a.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_text(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_text(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);elemModify.getAttribute("size")&&""!=elemModify.getAttribute("size")&&(document.getElementById("input_size").value=elemModify.getAttribute("size"));elemModify.getAttribute("maxlength")&&""!=elemModify.getAttribute("maxlength")&&(document.getElementById("input_maxtext").value=elemModify.getAttribute("maxlength"));"text"==elemModify.type?(document.getElementById("input_type_general").checked=!0,document.getElementById("input_type_password").checked=!1):"password"==elemModify.type&&(document.getElementById("input_type_general").checked=
!1,document.getElementById("input_type_password").checked=!0);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var b=a.eventFunction,a=a.eventName.split("\x0B"),b=b.split("\x0B"),c=a.length;for(i=0;i<c;i++){var e=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.appendChild(document.createTextNode(a[i]));
g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.appendChild(document.createTextNode(b[i]));l.appendChild(k);l.title=b[i];f.appendChild(g);d.appendChild(f);h.appendChild(l);d.appendChild(h);e.appendChild(d)}}}}
function dext_modify_input_text(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.setAttribute("value",document.getElementById("input_value").value),elemModify.value=document.getElementById("input_value").value):(elemModify.setAttribute("value",""),elemModify.value="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value&&
"0"!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value&&"0"!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_size").value&&
"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_maxtext").value&&"0"!=document.getElementById("input_maxtext").value?elemModify.maxLength=document.getElementById("input_maxtext").value:elemModify.removeAttribute("maxLength");for(var a=document.getElementsByName("input_type"),b=a.length,c=0;c<b;c++)if(1==a[c].checked){try{elemModify.type=a[c].value}catch(e){c='<input type="'+
a[c].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=c,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):
(c=elemModify.outerHTML,c=c.replace('name="'+elemModify.name+'"',""),c=c.replace("name='"+elemModify.name+"'",""),c=c.replace("name="+elemModify.name,""),c=c.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=c):elemModify.removeAttribute("name");var d=document.getElementById("event_table"),f=d.childNodes.length;if(0<f){for(var b=a="",c=0;c<f;c++)0!=c&&(a+="\x0B",b+="\x0B"),a+=d.childNodes[c].getElementsByTagName("span")[0].innerHTML,b+=d.childNodes[c].getElementsByTagName("span")[1].innerHTML;
""!=a&&(c={type:"event"},c.eventName=a,c.eventFunction=b,LayerWin.setDextCustomData(elemModify,c))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_radio_or_checkbox(a){var b={insertType:"",insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertChecked:!1,insertEventNameArr:[],insertEventFunctionArr:[]};b.insertType=a;b.insertName=document.getElementById("input_name").value;b.insertValue=document.getElementById("input_value").value;b.insertId=document.getElementById("input_id").value;b.insertClass=document.getElementById("input_class").value;b.insertTitle=
document.getElementById("input_title").value;b.insertWidth=document.getElementById("input_width").value;b.insertHeight=document.getElementById("input_height").value;b.insertDisabled=document.getElementById("input_disabled").checked;var c=document.getElementsByName("input_status"),e=c.length;for(a=0;a<e;a++)if(1==c[a].checked){b.insertChecked="true"==c[a].value?!0:!1;break}c=document.getElementById("event_table");e=c.childNodes.length;for(a=0;a<e;a++){var d=c.childNodes[a].getElementsByTagName("span");
b.insertEventNameArr.push(d[0].innerHTML);b.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_radio_or_checkbox(b,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_radio_or_checkbox(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.checked?document.getElementById("input_checked").checked=!0:document.getElementById("input_not_checked").checked=!0;if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));
if("event"==a.type){var b=a.eventFunction,a=a.eventName.split("\x0B"),b=b.split("\x0B"),c=a.length;for(i=0;i<c;i++){var e=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.innerHTML=
b[i];l.appendChild(k);l.title=b[i];f.appendChild(g);d.appendChild(f);h.appendChild(l);d.appendChild(h);e.appendChild(d)}}}}
function dext_modify_input_radio_or_checkbox(a){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?
elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+
"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;var b=document.getElementsByName("input_status"),c=b.length;for(a=0;a<c;a++)if(1==b[a].checked){"true"==b[a].value?(elemModify.checked=!0,elemModify.setAttribute("checked","checked")):(elemModify.checked=!1,elemModify.removeAttribute("checked"));break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",
document.getElementById("input_name").value):(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=a):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),d=e.childNodes.length;if(0<d){c=b="";for(a=0;a<d;a++)0!=a&&(b+="\x0B",c+="\x0B"),b+=e.childNodes[a].getElementsByTagName("span")[0].innerHTML,
c+=e.childNodes[a].getElementsByTagName("span")[1].innerHTML;""!=b&&(a={type:"event"},a.eventName=b,a.eventFunction=c,LayerWin.setDextCustomData(elemModify,a))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_button(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"button",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;for(var b=document.getElementsByName("input_type"),c=b.length,e=0;e<c;e++)if(1==b[e].checked){a.insertType=b[e].value;break}for(var b=document.getElementById("event_table"),c=b.childNodes.length,e=0;e<c;e++){var d=b.childNodes[e].getElementsByTagName("span");
a.insertEventNameArr.push(d[0].innerHTML);a.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_button(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_button(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);"button"==elemModify.type?(document.getElementById("input_general").checked=!0,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=!1):"reset"==elemModify.type?(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!0,document.getElementById("input_submit").checked=!1):"submit"==elemModify.type&&(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=
!0);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var b=a.eventFunction,a=a.eventName.split("\x0B"),b=b.split("\x0B"),c=a.length;for(i=0;i<c;i++){var e=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");
h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.innerHTML=b[i];l.appendChild(k);l.title=b[i];f.appendChild(g);d.appendChild(f);h.appendChild(l);d.appendChild(h);e.appendChild(d)}}}}
function dext_modify_input_button(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:
elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=
document.getElementById("input_disabled").checked;for(var a=document.getElementsByName("input_type"),b=a.length,c=0;c<b;c++)if(1==a[c].checked){try{elemModify.type=a[c].value}catch(e){c='<input type="'+a[c].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=c,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=
document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(c=elemModify.outerHTML,c=c.replace('name="'+elemModify.name+'"',""),c=c.replace("name='"+elemModify.name+"'",""),c=c.replace("name="+
elemModify.name,""),c=c.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=c):elemModify.removeAttribute("name");var d=document.getElementById("event_table"),f=d.childNodes.length;if(0<f){for(var b=a="",c=0;c<f;c++)0!=c&&(a+="\x0B",b+="\x0B"),a+=d.childNodes[c].getElementsByTagName("span")[0].innerHTML,b+=d.childNodes[c].getElementsByTagName("span")[1].innerHTML;""!=a&&(c={type:"event"},c.eventName=a,c.eventFunction=b,LayerWin.setDextCustomData(elemModify,
c))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function setInputSelectPageEvent(){var a=document.getElementById("input_value"),b=document.getElementById("btn_add"),c=document.getElementById("btn_modify"),e=document.getElementById("btn_delete"),d=document.getElementById("btn_up"),f=document.getElementById("btn_down");c.disabled=!0;c.className="non_btn";e.disabled=!0;e.className="non_btn";d.disabled=!0;d.className="non_btn";f.disabled=!0;f.className="non_btn";var g=document.getElementById("option_table");DEXTTOP.DEXT5.util.addEvent(b,"click",btn_select_add_click);
DEXTTOP.DEXT5.util.addEvent(c,"click",btn_select_mod_click);DEXTTOP.DEXT5.util.addEvent(e,"click",btn_select_del_click);DEXTTOP.DEXT5.util.addEvent(d,"click",btn_select_up_click);DEXTTOP.DEXT5.util.addEvent(f,"click",btn_select_down_click);DEXTTOP.DEXT5.util.addEvent(g,"click",function(a){a=a||window.event;var b=a.target?a.target:a.srcElement;a=document.getElementById("input_option");var h=document.getElementById("input_option_value");if(b=Dext5LayerWin.GetParentbyTagName(b,"tr"))_clicked_options=
b,b.style.background="#e5e5e5",a.value=b.getElementsByTagName("span")[0].innerHTML,h.value=b.getElementsByTagName("span")[1].innerHTML;for(a=0;a<g.childNodes.length;a++)g.childNodes[a]!=_clicked_options&&(g.childNodes[a].style.background="white");c.disabled=!1;c.className="in_btn";e.disabled=!1;e.className="in_btn";d.disabled=!1;d.className="in_btn";f.disabled=!1;f.className="in_btn"});var h=document.getElementById("input_multiselect");LayerWin.DEXTTOP.DEXT5.util.addEvent(h,"click",function(){if(0==
h.checked)for(var b=g.getElementsByTagName("input"),c=b.length,d=!1,e=0;e<c;e++)b[e].checked&&(d?b[e].checked=!1:(a.value=g.childNodes[e].getElementsByTagName("span")[1].innerHTML,d=!0))})}
function btn_select_add_click(){var a=document.getElementById("input_option"),b=document.getElementById("input_option_value");document.getElementById("btn_add");if(""!=a.value){var c=document.getElementById("option_table"),e=document.getElementById("input_value"),d=document.createElement("tr"),f=document.createElement("td");f.className="type";var g=document.createElement("input");g.type="checkbox";var h=document.createElement("td");h.className="type2";h.style.width="44%";var l=document.createElement("a"),
k=document.createElement("span");k.innerHTML=a.value;l.appendChild(k);l.title=a.value;k=document.createElement("td");k.className="type2";k.style.width="44%";var m=document.createElement("a"),n=document.createElement("span");n.innerHTML=b.value;m.appendChild(n);m.title=b.value;f.appendChild(g);d.appendChild(f);h.appendChild(l);d.appendChild(h);k.appendChild(m);d.appendChild(k);c.appendChild(d);a.value="";b.value="";LayerWin.DEXTTOP.DEXT5.util.addEvent(g,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==
g.checked)for(var a=c.getElementsByTagName("input"),b=a.length,d=0;d<b;d++)a[d]!=g?a[d].checked=!1:e.value=n.innerHTML;else e.value="";else if(1==g.checked)e.value=n.innerHTML;else for(a=c.getElementsByTagName("input"),b=a.length,e.value="",d=0;d<b;d++)if(a[d].checked){e.value=c.childNodes[d].getElementsByTagName("span")[1].innerHTML;break}})}}
function btn_select_mod_click(){if(_clicked_options){var a=document.getElementById("input_option"),b=document.getElementById("input_option_value");_clicked_options.getElementsByTagName("span")[0].innerHTML=a.value;_clicked_options.getElementsByTagName("span")[1].innerHTML=b.value}}
function btn_select_del_click(){document.getElementById("option_table");document.getElementById("btn_add");var a=document.getElementById("btn_modify"),b=document.getElementById("btn_delete"),c=document.getElementById("btn_up"),e=document.getElementById("btn_down");document.getElementById("input_option").value="";document.getElementById("input_option_value").value="";_clicked_options&&_clicked_options.parentNode.removeChild(_clicked_options);a.disabled=!0;a.className="non_btn";b.disabled=!0;b.className=
"non_btn";c.disabled=!0;c.className="non_btn";e.disabled=!0;e.className="non_btn"}function btn_select_up_click(){_clicked_options&&_clicked_options.previousSibling&&_clicked_options.parentNode.insertBefore(_clicked_options,_clicked_options.previousSibling)}function btn_select_down_click(){_clicked_options&&_clicked_options.nextSibling&&_clicked_options.parentNode.insertBefore(_clicked_options.nextSibling,_clicked_options)}
function setInputCommonEventPageEvent(){var a=document.getElementById("btn_event_add"),b=document.getElementById("btn_event_modify"),c=document.getElementById("btn_event_delete");b.disabled=!0;b.className="non_btn";c.disabled=!0;c.className="non_btn";var e=document.getElementById("event_table");DEXTTOP.DEXT5.util.addEvent(a,"click",btn_common_event_add_click);DEXTTOP.DEXT5.util.addEvent(b,"click",btn_common_event_mod_click);DEXTTOP.DEXT5.util.addEvent(c,"click",btn_common_event_del_click);DEXTTOP.DEXT5.util.addEvent(e,
"click",function(a){a=a||window.event;var f=a.target?a.target:a.srcElement;a=document.getElementById("input_event_name");var g=document.getElementById("input_event_function");if(f=Dext5LayerWin.GetParentbyTagName(f,"tr"))_clicked_event=f,f.style.background="#e5e5e5",a.value=f.getElementsByTagName("span")[0].innerHTML,g.value=f.getElementsByTagName("span")[1].innerHTML;for(a=0;a<e.childNodes.length;a++)e.childNodes[a]!=_clicked_event&&(e.childNodes[a].style.background="white");b.disabled=!1;b.className=
"in_btn";c.disabled=!1;c.className="in_btn"})}
function btn_common_event_add_click(){var a=document.getElementById("input_event_name"),b=document.getElementById("input_event_function");document.getElementById("btn_event_add");if(""!=a.value){var c=document.getElementById("event_table"),e=c.childNodes.length;if(0<e)for(var d=0;d<e;d++)if(a.value==c.childNodes[d].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}c=document.getElementById("event_table");e=document.createElement("tr");
d=document.createElement("td");d.className="type2";var f=document.createElement("a"),g=document.createElement("span");g.innerHTML=a.value;f.appendChild(g);f.title=a.value;a=document.createElement("td");a.className="type2";a.style.width="65%";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=b.value;g.appendChild(h);g.title=b.value;d.appendChild(f);e.appendChild(d);a.appendChild(g);e.appendChild(a);c.appendChild(e);b.value=""}}
function btn_common_event_mod_click(){if(_clicked_event){var a=document.getElementById("input_event_name"),b=document.getElementById("input_event_function"),c=document.getElementById("event_table"),e=c.childNodes.length;if(0<e)for(var d=0;d<e;d++)if("white"==c.childNodes[d].style.background&&a.value==c.childNodes[d].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}_clicked_event.getElementsByTagName("span")[0].innerHTML=a.value;
_clicked_event.getElementsByTagName("span")[1].innerHTML=b.value}}function btn_common_event_del_click(){document.getElementById("event_table");document.getElementById("btn_event_add");var a=document.getElementById("btn_event_modify"),b=document.getElementById("btn_event_delete");document.getElementById("input_event_function").value="";_clicked_event&&_clicked_event.parentNode.removeChild(_clicked_event);a.disabled=!0;a.className="non_btn";b.disabled=!0;b.className="non_btn"}
function dext_insert_input_select(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertSize:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertMultiselect:!1,insertOptionsArr:[],insertOptionsValueArr:[],insertOptionsSelected:[],insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertSize="0"==document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertMultiselect=document.getElementById("input_multiselect").checked;for(var b=document.getElementById("option_table"),c=b.childNodes.length,e=
0;e<c;e++){var d=b.childNodes[e].getElementsByTagName("span"),f=b.childNodes[e].getElementsByTagName("input")[0];a.insertOptionsArr.push(d[0].innerHTML);a.insertOptionsValueArr.push(d[1].innerHTML);a.insertOptionsSelected.push(f.checked)}b=document.getElementById("event_table");c=b.childNodes.length;for(e=0;e<c;e++)d=b.childNodes[e].getElementsByTagName("span"),a.insertEventNameArr.push(d[0].innerHTML),a.insertEventFunctionArr.push(d[1].innerHTML);LayerWin.event_dext_insert_input_select(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_select(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.size&&(document.getElementById("input_size").value=elemModify.size);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.multiple&&(document.getElementById("input_multiselect").checked=!0);for(var a=elemModify.getElementsByTagName("option"),
b=a.length,c=0;c<b;c++){var e=a[c].innerHTML,d=a[c].value;document.getElementById("btn_add");var f=document.getElementById("option_table"),g=document.getElementById("input_value"),h=document.createElement("tr"),l=document.createElement("td");l.className="type";var k=document.createElement("input");k.type="checkbox";var m=document.createElement("td");m.className="type2";m.style.width="44%";var n=document.createElement("a"),p=document.createElement("span");p.innerHTML=e;n.appendChild(p);n.title=e;p=
document.createElement("td");p.className="type2";p.style.width="44%";var e=document.createElement("a"),v=document.createElement("span");v.innerHTML=d;e.appendChild(v);e.title=d;l.appendChild(k);h.appendChild(l);m.appendChild(n);h.appendChild(m);p.appendChild(e);h.appendChild(p);f.appendChild(h);LayerWin.DEXTTOP.DEXT5.util.addEvent(k,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==k.checked)for(var a=f.getElementsByTagName("input"),b=a.length,c=0;c<b;c++)a[c]!=k?
a[c].checked=!1:g.value=v.innerHTML;else g.value="";else if(1==k.checked)g.value=v.innerHTML;else for(a=f.getElementsByTagName("input"),b=a.length,g.value="",c=0;c<b;c++)if(a[c].checked){g.value=f.childNodes[c].getElementsByTagName("span")[1].innerHTML;break}});a[c].selected&&(k.checked=!0)}if(elemModify.getAttribute("dext5customdata")&&(h=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==h.type))for(c=h.eventFunction,a=h.eventName.split("\x0B"),b=c.split("\x0B"),d=a.length,
c=0;c<d;c++)f=document.getElementById("event_table"),h=document.createElement("tr"),l=document.createElement("td"),l.className="type2",e=document.createElement("a"),m=document.createElement("span"),m.innerHTML=a[c],e.appendChild(m),e.title=a[c],m=document.createElement("td"),m.className="type2",m.style.width="65%",n=document.createElement("a"),p=document.createElement("span"),p.innerHTML=b[c],n.appendChild(p),n.title=b[c],l.appendChild(e),h.appendChild(l),m.appendChild(n),h.appendChild(m),f.appendChild(h)}
function dext_modify_input_select(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=
document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_size").value&&"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+
"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.multiple=document.getElementById("input_multiselect").checked;elemModify.innerHTML="";for(var a=document.getElementById("option_table"),b=a.childNodes.length,c=0;c<b;c++){var e=document.createElement("option");e.innerHTML=a.childNodes[c].getElementsByTagName("span")[0].innerHTML;
e.setAttribute("value",a.childNodes[c].getElementsByTagName("span")[1].innerHTML);e.selected=a.childNodes[c].getElementsByTagName("input")[0].checked;elemModify.appendChild(e)}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(c=elemModify.outerHTML,c=c.replace('name="'+elemModify.name+'"',""),c=c.replace("name='"+elemModify.name+"'",""),
c=c.replace("name="+elemModify.name,""),c=c.replace(">",' name="'+document.getElementById("input_name").value+'" >'),elemModify.outerHTML=c):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),d=e.childNodes.length;if(0<d){b=a="";for(c=0;c<d;c++)0!=c&&(a+="\x0B",b+="\x0B"),a+=e.childNodes[c].getElementsByTagName("span")[0].innerHTML,b+=e.childNodes[c].getElementsByTagName("span")[1].innerHTML;""!=a&&(c={type:"event"},c.eventName=a,c.eventFunction=b,LayerWin.setDextCustomData(elemModify,
c))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_textarea(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertAlign:"",insertDisabled:!1,insertReadonly:!1,insertRows:"",insertCols:"",insertWrap:"",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertRows="0"==document.getElementById("input_rows").value?"":document.getElementById("input_rows").value;a.insertCols="0"==
document.getElementById("input_cols").value?"":document.getElementById("input_cols").value;for(var b=document.getElementById("event_table"),c=b.childNodes.length,e=0;e<c;e++){var d=b.childNodes[e].getElementsByTagName("span");a.insertEventNameArr.push(d[0].innerHTML);a.insertEventFunctionArr.push(d[1].innerHTML)}LayerWin.event_dext_insert_input_textarea(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_textarea(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);""!=elemModify.value&&(document.getElementById("input_value").value=elemModify.value);""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=
parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0);""!=elemModify.rows&&(document.getElementById("input_rows").value=elemModify.rows);""!=elemModify.cols&&
(document.getElementById("input_cols").value=elemModify.cols);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var b=a.eventFunction,a=a.eventName.split("\x0B"),b=b.split("\x0B"),c=a.length;for(i=0;i<c;i++){var e=document.getElementById("event_table"),d=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=
a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.innerHTML=b[i];l.appendChild(k);l.title=b[i];f.appendChild(g);d.appendChild(f);h.appendChild(l);d.appendChild(h);e.appendChild(d)}}}}
function dext_modify_input_textarea(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.value=document.getElementById("input_value").value,elemModify.innerHTML=document.getElementById("input_value").value):(elemModify.value="",elemModify.innerHTML="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=
document.getElementById("input_height").value+"px":elemModify.style.height="";""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_rows").value&&"0"!=document.getElementById("input_rows").value?elemModify.rows=document.getElementById("input_rows").value:
elemModify.removeAttribute("rows");""!=document.getElementById("input_cols").value&&"0"!=document.getElementById("input_cols").value?elemModify.cols=document.getElementById("input_cols").value:elemModify.removeAttribute("cols");if(""!=document.getElementById("input_name").value)if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)elemModify.setAttribute("name",document.getElementById("input_name").value);else{var a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+
'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",' name="'+document.getElementById("input_name").value+'" >');elemModify.outerHTML=a}else elemModify.removeAttribute("name");var b=document.getElementById("event_table"),c=b.childNodes.length;if(0<c){for(var e=a="",d=0;d<c;d++)0!=d&&(a+="\x0B",e+="\x0B"),a+=b.childNodes[d].getElementsByTagName("span")[0].innerHTML,e+=b.childNodes[d].getElementsByTagName("span")[1].innerHTML;""!=a&&(b={type:"event"},
b.eventName=a,b.eventFunction=e,LayerWin.setDextCustomData(elemModify,b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_hidden(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;LayerWin.event_dext_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_hidden(){var a=elemModify.getAttribute("dext5customdata");null!=a&&void 0!=a&&(a=LayerWin.getDextCustomData(a),""!=a.id&&(document.getElementById("input_id").value=a.id),""!=a.name&&(document.getElementById("input_name").value=a.name),""!=a.value&&(document.getElementById("input_value").value=a.value),""!=a.className&&(document.getElementById("input_class").value=a.className),""!=a.title&&(document.getElementById("input_title").value=a.title))}
function dext_modify_input_hidden(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
LayerWin.event_dext_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function dext_insert_input_image(){var a=document.dext_upload_form,b=document.getElementById(file_field_id),c=document.getElementById("img_web_url"),b=document.getElementsByName("InputFlag")[0].checked?b.value:c.value;if(0<b.lastIndexOf(".")){for(var c=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowImageFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,h=0;h<g;h++)if(c==d[h]){e=!0;break}1==e?document.getElementsByName("InputFlag")[0].checked?
("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.image_convert_height)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=
LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height),loading_image_show(!0),a.action=document.getElementById("upload_url").value,
a.submit()):event_dext_input_image_upload_completed(b):alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_input_image_upload_completed(a){var b=document.getElementById("input_width").value,c=document.getElementById("input_height").value,e=0,d=0;if(null!=a&&void 0!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");if((a=a.replace(/\t/g,""))&&""!=a)try{var f=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=f&&void 0!=f&&(a=f)}catch(g){}f=a.split("?");2==f.length&&(a=f[0],f=f[1].split("^"),2==f.length?(e=f[0],d=f[1]):3==f.length&&(e=f[0],d=f[1],a+="?"+
f[2]));if(elemModify&&"input"==elemModify.tagName.toLowerCase()&&"image"==elemModify.type){elemModify.src=a;return}if("1"==LayerWin._dext_editor._config.image_auto_fit&&e>LayerWin._dext_editor._defaultWidth)f=LayerWin._dext_editor._defaultWidth/e,e=LayerWin._dext_editor._defaultWidth,d*=f;else if("2"==LayerWin._dext_editor._config.image_auto_fit&&(e>LayerWin._dext_editor._defaultWidth||d>LayerWin._dext_editor._defaultHeight)){var b=LayerWin._dext_editor._defaultWidth,c=LayerWin._dext_editor._defaultHeight,
f=c/b,h=d/e;h>f?d>c?b=Math.round(e*c/d):(b=e,c=d):h<f?e>b?c=Math.round(d*b/e):(b=e,c=d):(b=e,c=d)}}0==b.length&&0<e&&(b=parseInt(e),c=parseInt(d));loading_image_show(!1);if("/"!=LayerWin._dext_editor._config.serverDomain&&(4>a.length||"http"!=a.substring(0,4).toLowerCase()))confirm(LayerWin.dext5_lang.msg.uploadFailed)&&alert(a);else{a=web_url_remove_char(a);a={insertName:"",insertValue:"",insertSrc:a,insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,
insertType:"image",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth=b;a.insertHeight=c;a.insertDisabled=document.getElementById("input_disabled").checked;
e=document.getElementById("event_table");d=e.childNodes.length;for(b=0;b<d;b++)c=e.childNodes[b].getElementsByTagName("span"),a.insertEventNameArr.push(c[0].innerHTML),a.insertEventFunctionArr.push(c[1].innerHTML);LayerWin.event_dext_insert_input_image(a,window.frameElement.parentNode.parentNode)}}
function set_modify_field_input_image(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.align);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);var a=elemModify.src.split("/");document.getElementById("img_web_url").value=a[a.length-
1];document.getElementsByName("InputFlag")[0].disabled="disabled";document.getElementsByName("InputFlag")[1].disabled="disabled";var b=document.getElementById("img_ratio"),c=document.getElementById("input_width"),e=document.getElementById("input_height"),d,f;d=c.value;f=e.value;c.value=Math.round(d);e.value=Math.round(f);"1"==LayerWin._dext_editor._config.allowImgSize&&(b.style.display="block",b.className="img_link_active_btn",b.setAttribute("ratio-checked","true"));DEXTTOP.DEXT5.util.addEvent(c,
"keyup",function(){if("true"==b.getAttribute("ratio-checked")){var a=parseInt(f,10)*parseInt(c.value,10)/parseInt(d,10);e.value=isNaN(a)?e.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(e,"keyup",function(){if("true"==b.getAttribute("ratio-checked")){var a=parseInt(d,10)*parseInt(e.value,10)/parseInt(f,10);c.value=isNaN(a)?c.value:Math.round(a)}});if(elemModify.getAttribute("dext5customdata")&&(a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==a.type)){var g=a.eventFunction,
a=a.eventName.split("\x0B"),g=g.split("\x0B"),h=a.length;for(i=0;i<h;i++){var l=document.getElementById("event_table"),k=document.createElement("tr"),m=document.createElement("td");m.className="type2";var n=document.createElement("a"),p=document.createElement("span");p.innerHTML=a[i];n.appendChild(p);n.title=a[i];p=document.createElement("td");p.className="type2";p.style.width="65%";var v=document.createElement("a"),z=document.createElement("span");z.innerHTML=g[i];v.appendChild(z);v.title=g[i];m.appendChild(n);
k.appendChild(m);p.appendChild(v);k.appendChild(p);l.appendChild(k)}}}
function dext_modify_input_image(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var a=document.getElementById(file_field_id);a.value&&""!=a.value&&dext_insert_input_image();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.align=document.getElementById("input_textalign").value:elemModify.removeAttribute("align");""!=document.getElementById("input_width").value?
elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):
(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=a):elemModify.removeAttribute("name");var b=document.getElementById("event_table"),c=b.childNodes.length;if(0<c){for(var e=a="",d=0;d<c;d++)0!=d&&(a+="\x0B",e+="\x0B"),a+=b.childNodes[d].getElementsByTagName("span")[0].innerHTML,e+=b.childNodes[d].getElementsByTagName("span")[1].innerHTML;
""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=e,LayerWin.setDextCustomData(elemModify,b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}function event_dext_horizontal_line_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_image_upload_cancel(){"1"==LayerWin._dext_editor._config.uploadUseHTML5&&"function"==typeof uploadAjaxOnprogressCancel&&uploadAjaxOnprogressCancel();LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_bg_image_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_flash_upload_cancel(){clearWindow(window);LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_media_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_table_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_doc_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_emoticon_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_about_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_close(a){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_insert_datetime_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_insert_datetime(a){LayerWin.command_insert_datetime(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,a)}function clearWindow(a){a.document.open("text/html","replace");isCustomDomain()&&(a.document.domain=LayerWin.document.domain);a.document.write("<html><head></head><body></body></html>");a.document.close()}function isCustomDomain(){if(!DEXTTOP.DEXT5.browser.ie)return!1;var a=LayerWin.document.domain,b=window.location.hostname;return a!=b&&a!="["+b+"]"}
function setCursorPos(a,b,c){null!=a&&void 0!=a&&null==navigator.userAgent.match(/iPhone|iPad/)&&setTimeout(function(){var e=0;a.value&&(e=a.value.length);try{if(0!=e&&0!=b)if("setSelectionRange"in a)c?a.setSelectionRange(0,e):a.setSelectionRange(e,e);else if("createTextRange"in a){var d=a.createTextRange();c||d.moveStart("character",e);d.select()}a.focus()}catch(f){}},0)}
function event_tab(a,b){9==("which"in a?a.which:a.keyCode)&&"last"==(a.target?a.target:a.srcElement).getAttribute("last_cursor_obj")&&(setCursorPos(b,!0,!1),DEXTTOP.DEXT5.util.cancelEvent(a))}
function edgeClick(a,b){LayerWin._dext_editor.applyEdgeMode="user";edgeSelectClick(4,"user");var c=document.getElementById("topcell1"),e=document.getElementById("topcell2"),d=document.getElementById("bottomcell1"),f=document.getElementById("bottomcell2");document.getElementById("edge_top");document.getElementById("edge_horizon");document.getElementById("edge_bottom");document.getElementById("edge_left");document.getElementById("edge_vertical");document.getElementById("edge_right");var g=document.getElementById("edge_"+
a).src.split("/");if(g[g.length-1]=="editor_line_"+a+"_d_img.gif")document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_img.gif",g="",g=""==document.getElementById("line_kind").value?g+(document.getElementById("line_thickness").value+"px"):g+document.getElementById("line_kind").value,g+=" "+document.getElementById("line_style").style.borderTopStyle,g+=" "+document.getElementById("line_color").style.borderTopColor,"top"==a?(c&&(c.style.borderTop=g,cellRemoveClass(c,"dext_cell_border_t")),
e&&(e.style.borderTop=g,cellRemoveClass(e,"dext_cell_border_t"))):"horizon"==a?(d&&(c.style.borderBottom=g,d.style.borderTop=g,cellRemoveClass(c,"dext_cell_border_b"),cellRemoveClass(d,"dext_cell_border_t")),f&&(e.style.borderBottom=g,f.style.borderTop=g,cellRemoveClass(e,"dext_cell_border_b"),cellRemoveClass(f,"dext_cell_border_t"))):"bottom"==a?d?(d.style.borderBottom=g,cellRemoveClass(d,"dext_cell_border_b"),f&&(f.style.borderBottom=g,cellRemoveClass(f,"dext_cell_border_b"))):(c&&(c.style.borderBottom=
g,cellRemoveClass(c,"dext_cell_border_b")),e&&(e.style.borderBottom=g,cellRemoveClass(e,"dext_cell_border_b"))):"left"==a?(c&&(c.style.borderLeft=g,cellRemoveClass(c,"dext_cell_border_l")),d&&(d.style.borderLeft=g,cellRemoveClass(d,"dext_cell_border_l"))):"vertical"==a?(e&&(c.style.borderRight=g,e.style.borderLeft=g,cellRemoveClass(c,"dext_cell_border_r"),cellRemoveClass(e,"dext_cell_border_l")),f&&(d.style.borderRight=g,f.style.borderLeft=g,cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(f,
"dext_cell_border_l"))):"right"==a&&(e?(e.style.borderRight=g,cellRemoveClass(e,"dext_cell_border_r"),f&&(f.style.borderRight=g,cellRemoveClass(f,"dext_cell_border_r"))):(c&&(c.style.borderRight=g,cellRemoveClass(c,"dext_cell_border_r")),d&&(d.style.borderRight=g,cellRemoveClass(d,"dext_cell_border_r"))));else if(g[g.length-1]=="editor_line_"+a+"_img.gif"){document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_d_img.gif";var h=g="";b||(g="1px solid rgb(0, 0, 0)",h="1px");
"top"==a?(c&&(c.style.borderTop=g,c.style.borderTopWidth=h,b&&(c.className+=" dext_cell_border_t")),e&&(e.style.borderTop=g,e.style.borderTopWidth=h,b&&(e.className+=" dext_cell_border_t"))):"horizon"==a?(d&&(c.style.borderBottom=g,d.style.borderTop=g,c.style.borderBottomWidth=h,d.style.borderTopWidth=h,b&&(c.className+=" dext_cell_border_b",d.className+=" dext_cell_border_t")),f&&(e.style.borderBottom=g,f.style.borderTop=g,e.style.borderBottomWidth=h,f.style.borderTopWidth=h,b&&(e.className+=" dext_cell_border_b",
f.className+=" dext_cell_border_t"))):"bottom"==a?d?(d.style.borderBottom=g,d.style.borderBottomWidth=h,b&&(d.className+=" dext_cell_border_b"),f&&(f.style.borderBottom=g,f.style.borderBottomWidth=h,b&&(f.className+=" dext_cell_border_b"))):(c&&(c.style.borderBottom=g,c.style.borderBottomWidth=h,b&&(c.className+=" dext_cell_border_b")),e&&(e.style.borderBottom=g,e.style.borderBottomWidth=h,b&&(e.className+=" dext_cell_border_b"))):"left"==a?(c&&(c.style.borderLeft=g,c.style.borderLeftWidth=h,b&&(c.className+=
" dext_cell_border_l")),d&&(d.style.borderLeft=g,d.style.borderLeftWidth=h,b&&(d.className+=" dext_cell_border_l"))):"vertical"==a?(e&&(c.style.borderRight=g,e.style.borderLeft=g,c.style.borderRightWidth=h,e.style.borderLeftWidth=h,b&&(c.className+=" dext_cell_border_r",e.className+=" dext_cell_border_l")),f&&(d.style.borderRight=g,f.style.borderLeft=g,d.style.borderRightWidth=h,f.style.borderLeftWidth=h,b&&(d.className+=" dext_cell_border_r",f.className+=" dext_cell_border_l"))):"right"==a&&(e?(e.style.borderRight=
g,e.style.borderRightWidth=h,b&&(e.className+=" dext_cell_border_r"),f&&(f.style.borderRight=g,f.style.borderRightWidth=h,b&&(f.className+=" dext_cell_border_r"))):(c&&(c.style.borderRight=g,c.style.borderRightWidth=h,b&&(c.className+=" dext_cell_border_r")),d&&(d.style.borderRight=g,d.style.borderRightWidth=h,b&&(d.className+=" dext_cell_border_r"))))}}
function cellRemoveClass(a,b){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");c.test(a.className)&&(a.className=LayerWin.DEXTTOP.DEXT5.util.trim(a.className.replace(c," ")));""==LayerWin.DEXTTOP.DEXT5.util.trim(a.className)&&a.removeAttribute("class")}
function edgeNoneTotalClick(a){if("user"!=a){var b="",b=""==document.getElementById("line_kind").value?b+(document.getElementById("line_thickness").value+"px"):b+document.getElementById("line_kind").value,b=b+(" "+document.getElementById("line_style").style.borderTopStyle),b=b+(" "+document.getElementById("line_color").style.borderTopColor),c=document.getElementById("topcell1"),e=document.getElementById("topcell2"),d=document.getElementById("bottomcell1"),f=document.getElementById("bottomcell2"),
g=document.getElementById("edge_top"),h=document.getElementById("edge_horizon"),l=document.getElementById("edge_bottom"),k=document.getElementById("edge_left"),m=document.getElementById("edge_vertical"),n=document.getElementById("edge_right");"total"==a?(g&&(g.src="../images/editor/dialog/editor_line_top_img.gif"),h&&(h.src="../images/editor/dialog/editor_line_horizon_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_bottom_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_left_img.gif"),
m&&(m.src="../images/editor/dialog/editor_line_vertical_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif"),c&&(c.style.borderTop=b,c.style.borderBottom=b,c.style.borderRight=b,c.style.borderLeft=b,cellRemoveClass(c,"dext_cell_border_l"),cellRemoveClass(c,"dext_cell_border_r"),cellRemoveClass(c,"dext_cell_border_t"),cellRemoveClass(c,"dext_cell_border_b")),e&&(e.style.borderTop=b,e.style.borderLeft=b,e.style.borderRight=b,e.style.borderBottom=b,cellRemoveClass(e,"dext_cell_border_l"),
cellRemoveClass(e,"dext_cell_border_r"),cellRemoveClass(e,"dext_cell_border_t"),cellRemoveClass(e,"dext_cell_border_b")),d&&(d.style.borderTop=b,d.style.borderBottom=b,d.style.borderRight=b,d.style.borderLeft=b,cellRemoveClass(d,"dext_cell_border_l"),cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(d,"dext_cell_border_t"),cellRemoveClass(d,"dext_cell_border_b")),f&&(f.style.borderTop=b,f.style.borderLeft=b,f.style.borderRight=b,f.style.borderBottom=b,cellRemoveClass(f,"dext_cell_border_l"),
cellRemoveClass(f,"dext_cell_border_r"),cellRemoveClass(f,"dext_cell_border_t"),cellRemoveClass(f,"dext_cell_border_b"))):"inside"==a?(h&&(h.src="../images/editor/dialog/editor_line_horizon_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_vertical_img.gif"),c&&e&&(c.style.borderRight=b,e.style.borderLeft=b,cellRemoveClass(c,"dext_cell_border_r"),cellRemoveClass(e,"dext_cell_border_l")),d&&f&&(d.style.borderRight=b,f.style.borderLeft=b,cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(f,
"dext_cell_border_l")),c&&d&&(c.style.borderBottom=b,d.style.borderTop=b,cellRemoveClass(c,"dext_cell_border_b"),cellRemoveClass(d,"dext_cell_border_t")),e&&f&&(e.style.borderBottom=b,f.style.borderTop=b,cellRemoveClass(e,"dext_cell_border_b"),cellRemoveClass(f,"dext_cell_border_t"))):"outside"==a?(g&&(g.src="../images/editor/dialog/editor_line_top_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_bottom_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_left_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif"),
c&&e?(c.style.borderTop=b,c.style.borderLeft=b,e.style.borderTop=b,e.style.borderRight=b,cellRemoveClass(c,"dext_cell_border_t"),cellRemoveClass(c,"dext_cell_border_l"),cellRemoveClass(e,"dext_cell_border_t"),cellRemoveClass(e,"dext_cell_border_r")):c&&(c.style.borderTop=b,c.style.borderLeft=b,c.style.borderRight=b,cellRemoveClass(c,"dext_cell_border_t"),cellRemoveClass(c,"dext_cell_border_l"),cellRemoveClass(c,"dext_cell_border_r")),d&&f?(d.style.borderLeft=b,d.style.borderBottom=b,f.style.borderRight=
b,f.style.borderBottom=b,cellRemoveClass(d,"dext_cell_border_l"),cellRemoveClass(d,"dext_cell_border_b"),cellRemoveClass(f,"dext_cell_border_r"),cellRemoveClass(f,"dext_cell_border_b")):d?(d.style.borderLeft=b,d.style.borderRight=b,d.style.borderBottom=b,cellRemoveClass(d,"dext_cell_border_l"),cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(d,"dext_cell_border_b")):(c&&(c.style.borderBottom=b,cellRemoveClass(c,"dext_cell_border_b")),e&&(e.style.borderBottom=b,cellRemoveClass(e,"dext_cell_border_b")))):
"none"==a&&(g&&(g.src="../images/editor/dialog/editor_line_top_d_img.gif"),h&&(h.src="../images/editor/dialog/editor_line_horizon_d_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_bottom_d_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_left_d_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_vertical_d_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_d_img.gif"),c&&(c.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),e&&
(e.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),d&&(d.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),f&&(f.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"))}}function fnLineStyleToggle(){var a=document.getElementById("line_style_list");a.style.display="none"==a.style.display?"block":"none"}
function lineStyleChange(){var a=document.getElementById("line_style"),b=document.getElementById("line_thickness");if("hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle)b.value="0";else if("solid"!=a.style.borderTopStyle&&"dotted"!=a.style.borderTopStyle&&"dashed"!=a.style.borderTopStyle&&"hidden"!=a.style.borderTopStyle&&"none"!=a.style.borderTopStyle){if(isNaN(parseInt(b.value,10))||3>parseInt(b.value,10))b.value="3"}else if(isNaN(parseInt(b.value,10))||0>=parseInt(b.value,10))b.value=
"1";edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function lineKindChange(){var a=document.getElementById("line_kind"),b=document.getElementById("line_thickness"),c=document.getElementById("line_thickness_updn_btn");""!=a.value?(b.disabled=!0,c.style.display="none"):(b.disabled=!1,c.style.display="block");edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function imgLineKindChange(){var a=document.getElementById("line_kind"),b=document.getElementById("line_thickness"),c=document.getElementById("line_thickness_updn_btn");""!=a.value?(b.disabled=!0,b.value="",c.style.display="none"):(b.disabled=!1,c.style.display="block")}function lineThicknessChange(){var a=document.getElementById("line_thickness");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function cellGapChange(){var a=document.getElementById("cell_gap");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function insideMarginChange(){var a=document.getElementById("cell_inside_margin");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function tableEdgeReduceChange(){edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function getColorHex(a){return-1<a.indexOf("#")?a:LayerWin.DEXTTOP.DEXT5.util.rgb2hex(a)?LayerWin.DEXTTOP.DEXT5.util.rgb2hex(a):"#000000"}
function setLineStyleEvt(){var a=document.getElementById("ul_line_style");LayerWin.DEXTTOP.DEXT5.util.addEvent(a,"click",function(a){var c=document.getElementById("line_style");a=LayerWin.getClickCell(a,"li").getElementsByTagName("SPAN")[0];c.style.border="";"solid"==a.style.borderTopStyle||"dotted"==a.style.borderTopStyle||"dashed"==a.style.borderTopStyle||"double"==a.style.borderTopStyle||"hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle?c.style.borderTop=a.style.borderTop:c.style.border=
a.style.border;fnLineStyleToggle();setCursorPos(document.getElementById("line_style_btn"),!1,!1);lineStyleChange()})}
function setCellBorderModifyValue(a){var b=LayerWin.DEXTTOP.G_SELECTED_ELEMENT;if(a){a=LayerWin.GetTableSelectionCells(b);for(var b=a.length,c=!0,e=0;e<b-1;e++){if(a[e].style.borderTopStyle!=a[e+1].style.borderTopStyle||a[e].style.borderTopWidth!=a[e+1].style.borderTopWidth||a[e].style.borderTopColor!=a[e+1].style.borderTopColor){c=!1;break}if(a[e].style.borderRightStyle!=a[e+1].style.borderRightStyle||a[e].style.borderRightWidth!=a[e+1].style.borderRightWidth||a[e].style.borderRightColor!=a[e+1].style.borderRightColor){c=
!1;break}if(a[e].style.borderBottomStyle!=a[e+1].style.borderBottomStyle||a[e].style.borderBottomWidth!=a[e+1].style.borderBottomWidth||a[e].style.borderBottomColor!=a[e+1].style.borderBottomColor){c=!1;break}if(a[e].style.borderLeftStyle!=a[e+1].style.borderLeftStyle||a[e].style.borderLeftWidth!=a[e+1].style.borderLeftWidth||a[e].style.borderLeftColor!=a[e+1].style.borderLeftColor){c=!1;break}}c?setModifyValue(a[0].style,!0):setModifyValue(null)}else setModifyValue(b.style,!0)}
function setTableBorderModifyValue(a){if("separate"==a.style.borderCollapse)setModifyValue(a.style,!0);else{var b=!0,c=!0,e=!0,d=!0,f,g,h,l;a=LayerWin.getTableBorderCells(a);var k=a.arrTop.length;if(1==k)f=a.arrTop[0].style.borderTop;else for(var m=0;m<k;m++)0!=m&&(a.arrTop[m-1].style.borderTop!=a.arrTop[m].style.borderTop&&(b=!1),m==k-1&&b&&(f=a.arrTop[m].style.borderTop));k=a.arrLeft.length;if(1==k)h=a.arrLeft[0].style.borderLeft;else for(m=0;m<k;m++)0!=m&&(a.arrLeft[m-1].style.borderLeft!=a.arrLeft[m].style.borderLeft&&
(d=!1),m==k-1&&d&&(h=a.arrLeft[m].style.borderLeft));k=a.arrRight.length;if(1==k)l=a.arrRight[0].style.borderRight;else for(m=0;m<k;m++)0!=m&&(a.arrRight[m-1].style.borderRight!=a.arrRight[m].style.borderRight&&(e=!1),m==k-1&&e&&(l=a.arrRight[m].style.borderRight));k=a.arrBottom.length;if(1==k)g=a.arrBottom[0].style.borderBottom;else for(m=0;m<k;m++)0!=m&&(a.arrBottom[m-1].style.borderBottom!=a.arrBottom[m].style.borderBottom&&(c=!1),m==k-1&&c&&(g=a.arrBottom[m].style.borderBottom));a=document.createElement("td");
a.style.borderTop=f?f:"1px solid #000000";a.style.borderBottom=g?g:"1px solid #000000";a.style.borderLeft=h?h:"1px solid #000000";a.style.borderRight=l?l:"1px solid #000000";f=!1;a.style.borderTop==a.style.borderRight&&a.style.borderRight==a.style.borderBottom&&a.style.borderBottom==a.style.borderLeft&&b&&c&&e&&d&&(f=!0);setModifyValue(a.style,f)}}
function setModifyValue(a,b){if(a){var c=b,e,d,f,g;e=a.borderTopWidth;d=a.borderBottomWidth;f=a.borderRightWidth;g=a.borderLeftWidth;e==d&&d==f&&f==g?-1<e.indexOf("px")?document.getElementById("line_thickness").value=parseInt(e,10):document.getElementById("line_kind").value=e:(document.getElementById("line_thickness").value="1",document.getElementById("line_kind").value="");e+=" ";d+=" ";f+=" ";g+=" ";a.borderTopStyle==a.borderRightStyle&&a.borderRightStyle==a.borderLeftStyle&&a.borderLeftStyle==
a.borderBottomStyle?("solid"==a.borderStyle||"dotted"==a.borderStyle||"dashed"==a.borderStyle||"double"==a.borderStyle||"hidden"==a.borderStyle||"none"==a.borderStyle?document.getElementById("line_style").style.borderTopStyle=a.borderStyle:document.getElementById("line_style").style.borderStyle=a.borderStyle,"solid"!=a.borderTopStyle&&"dotted"!=a.borderTopStyle&&"dashed"!=a.borderTopStyle&&"hidden"!=a.borderTopStyle&&"none"!=a.borderTopStyle?(document.getElementById("line_style").style.borderWidth=
"3px","double"==a.borderTopStyle?document.getElementById("line_style").style.borderColor="#5d5d5d":document.getElementById("line_style").style.borderColor="#e1e1e1"):(document.getElementById("line_style").style.borderTopWidth="1px",document.getElementById("line_style").style.borderTopColor="#5d5d5d")):(document.getElementById("line_style").style.borderTopStyle="none",c=!1);e+=a.borderTopStyle+" ";d+=a.borderBottomStyle+" ";f+=a.borderRightStyle+" ";g+=a.borderLeftStyle+" ";var h=getColorHex(a.borderTopColor),
l=getColorHex(a.borderBottomColor),k=getColorHex(a.borderRightColor),m=getColorHex(a.borderLeftColor);h==l&&l==k&&k==m&&(document.getElementById("line_color").style.borderTopColor=h);e+=h;d+=l;f+=k;g+=m;document.getElementById("edge_border").style.borderTop=e;document.getElementById("edge_border").style.borderBottom=d;document.getElementById("edge_border").style.borderRight=f;document.getElementById("edge_border").style.borderLeft=g;c||edgeNoneTotalClick("none")}else document.getElementById("line_style").style.borderTopStyle=
"none",edgeNoneTotalClick("none")}function setLayout(a){a=a.replace("te","");a={num:a};0==LayerWin.DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_layout(a,window.frameElement.parentNode.parentNode):LayerWin.event_dext_layout(a,window.frameElement.parentNode.parentNode)}
function event_dext_file_upload_completed(a){loading_image_show(!1);if(a&&""!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");try{var b=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(c){}}if("[FAIL]"==a.substring(0,6))try{if(0==DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a}))return}catch(e){}var b=document.getElementById("file_title").value,d=document.getElementById("file_text").value;
"1"==LayerWin._dext_editor._config.security.encryptParam&&(d=DEXTTOP.DEXT5.util.makeDecryptReponseMessage(d));var f=document.getElementById("input_id").value,g=document.getElementById("input_class").value;if(""==d)var h=document.getElementById(file_field_id).value,d=getFileName(h);h=a;null!=a&void 0!=a&&(a=a.split("?"),2==a.length&&(h=a[0],a=a[1].split("^"),3==a.length&&(h+="?"+a[2])),""==d&&(d=h.split("/"),d=d[d.length-1]));a=h.substring(h.lastIndexOf(".")+1).toLowerCase();a=a.toLowerCase();LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,
h);b={text:d,url:h,target:"_blank",title:b,type:"hyperlink",type2:"insert_file",file_ext:a,id:f,className:g};elemModify&&"a"==elemModify.tagName.toLowerCase()?(elemModify.innerHTML=b.text,elemModify.title=b.title,elemModify.id=b.id,elemModify.className=b.className,elemModify.href=b.url,"1"==LayerWin._dext_editor._config.attachFileImage&&LayerWin.attachFileImage(elemModify,b),LayerWin._dext_editor.UndoManager.putUndo(),event_dext_close()):LayerWin.event_dext_insert_file(b,window.frameElement.parentNode.parentNode)}
function dext_upload_file(){var a=document.dext_upload_form,b;b=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var c=b.value;if(0<c.lastIndexOf(".")){for(var c=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,d=LayerWin._dext_editor._config.allowInsertFileType,f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,
h=0;h<g;h++)if(c==d[h]){e=!0;break}d=document.getElementById("file_text").value;1==e?("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=
DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("savafiletext").value=DEXTTOP.DEXT5.util.makeEncryptParam(d),document.getElementById("file_text").value=DEXTTOP.DEXT5.util.makeEncryptParam(d)):
(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,
document.getElementById("savafiletext").value=d),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"1"==LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe","1"),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),
a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("savafiletext",document.getElementById("savafiletext").value),a.setItem(LayerWin._dext_editor._config.userFieldID,
document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"insert_file",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:b.id,fileObj:G_dragDropFileObj,formData:a},event_dext_file_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}function getFileName(a){var b="";if(a&&0<a.length)return b=a,a=a.split("\\"),0<a.length&&(b=a[a.length-1]),b}
function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}
function dext_upload_open_file(){var a=document.dext_upload_form,b=document.getElementById(file_field_id),c=b.value;if(0<c.lastIndexOf(".")){for(var c=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,d=["htm","html","txt"],f=d.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=d.length,h=0;h<g;h++)if(c==d[h]){e=!0;break}if(1==e){if(0!=DEXTTOP.DEXT5.isEmpty()||0!=confirm(LayerWin.dext5_lang.msg.newDocument))"1"==LayerWin._dext_editor._config.openDocument.useHtml5FileOpen?(loading_image_show(!0),
handleFileSelect(b.files)):("1"==LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParam(c),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParam(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.toSavePathURL),
document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParam(LayerWin._dext_editor._config.saveFileNameRule)):(document.getElementById("savefileext").value=c,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=
LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),loading_image_show(!0),a.action=document.getElementById("upload_url").value,a.submit())}else alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_open_file_upload_completed(a){var b=document.getElementById(file_field_id).value;a={fileExt:b.substring(b.lastIndexOf(".")+1).toLowerCase(),data:a};LayerWin.event_dext_insert_open_file(a,window.frameElement.parentNode.parentNode)}function dext_blockquote(){var a={tagvalue:document.getElementById("tempblockquote").value};LayerWin.event_dext_insert_blockquote(a,window.frameElement.parentNode.parentNode)}
function dext_blockquoteCancel(){LayerWin.event_dext_cancel_blockquote(window.frameElement.parentNode.parentNode)}
function dext_setAccessibility(a,b){var c=document.getElementById("input_title").value,e=document.getElementById("input_alt").value,d=document.getElementById("chk_skip").checked,f=document.getElementById("input_id").value,g;b.parentNode.cells[1].getElementsByTagName("span")[2]&&(g=b.parentNode.cells[1].getElementsByTagName("span")[2].innerHTML);var h=!1;""==document.getElementById("id_tr").style.display&&(h=!0);LayerWin.event_dext_setAccessibility({title:c,alt:e,skip:d,id:f,idSamMode:h,sameOrgId:g},
a,b)}
function fileOnchange(a,b){if(fileDataObj=document.getElementById(LayerWin._dext_editor._config.fileFieldID))if(fileDataObj&&fileDataObj.value){if(("1"==LayerWin._dext_editor._config.uploadUseHTML5||"insert_file"==b)&&void 0!=b){var c=getFileName(fileDataObj.value);document.getElementById("file_text").value=c}}else"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"==b&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(document.getElementById("file_text").value="");b&&a&&a.files&&
0<a.files.length&&"1"==LayerWin._dext_editor._config.uploadUseHTML5&&(G_dragDropFileObj=a.files);G_dragDropFileObj&&(document.getElementById("drop_zone").innerHTML=G_dragDropFileObj[0].name,document.getElementById("drop_zone").className="DEXT_fiVe_ED_Popup_DropZoneNoneBackground");if(b&&(a&&a.files&&0<a.files.length||G_dragDropFileObj)&&DEXTTOP.DEXT5.browser.HTML5Supported){var c=!1,e=LayerWin.dext5_lang.msg.max_file_size,d=0,d=a&&a.files&&0<a.files.length?a.files[0].size:G_dragDropFileObj[0].size;
("image"==b||"m_image"==b||"input_image"==b)&&0!=LayerWin._dext_editor._config.maxImageFileSize&&d>LayerWin._dext_editor._config.maxImageFileSize?(e=e.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxImageFileSize).toString),c=!0):"media"==b&&0!=LayerWin._dext_editor._config.maxMediaFileSize&&d>LayerWin._dext_editor._config.maxMediaFileSize?(e=e.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxMediaFileSize).toString),c=!0):"flash"==b&&0!=
LayerWin._dext_editor._config.maxFlashFileSize&&d>LayerWin._dext_editor._config.maxFlashFileSize?(e=e.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxFlashFileSize).toString),c=!0):"insert_file"==b&&0!=LayerWin._dext_editor._config.maxInsertFileSize&&d>LayerWin._dext_editor._config.maxInsertFileSize&&(e=e.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxInsertFileSize).toString),c=!0);if(c){alert(e);"1"==LayerWin._dext_editor._config.uploadUseHTML5?
(1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content,G_dragDropFileObj=null):document.getElementById("image_url").value="";a.value="";return}}("image"==b||"m_image"==b)&&"base64"==LayerWin._dext_editor._config.uploadMethod&&null==elemModify&&(a&&a.files&&0<a.files.length||G_dragDropFileObj)&&"-1"!=LayerWin._dext_editor._config.maxImageBase64fileCount&&
LayerWin.getBase64ImageCount()>=parseInt(LayerWin._dext_editor._config.maxImageBase64fileCount,10)?(e=LayerWin.dext5_lang.msg.max_base64file_count,e=e.replace("{0}",LayerWin._dext_editor._config.maxImageBase64fileCount),alert(e),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content,G_dragDropFileObj=
null):document.getElementById("image_url").value="",a.value=""):document.getElementById("image_url")&&(c=a.value.split("\\"),document.getElementById("image_url").value=c[c.length-1])}
function set_page_table_lock_property(){DEXTTOP.DEXT5.util.addEvent(document.getElementById("ok_btn"),"click",function(){applyTableLockProperty()});var a=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);if(a){var b=LayerWin.checkLockAttr(a,!0),c=document.getElementsByName("table_lock");b?(c[0].checked=!0,c[1].checked=!1):(c[0].checked=!1,c[1].checked=!0);a.getAttribute("lock_mode")&&(e=a.getAttribute("lock_mode"));b=document.getElementsByName("lock_mode");"1"==e?(b[0].checked=!0,
b[1].checked=!1):(b[0].checked=!1,b[1].checked=!0);var e=DEXTTOP.G_CURREDITOR._config.defaultTableLockMode;a.getAttribute("lock_mode")&&(e=a.getAttribute("lock_mode"));b=document.getElementsByName("lock_mode");"1"==e?(b[0].checked=!0,b[1].checked=!1):(b[0].checked=!1,b[1].checked=!0);e=DEXTTOP.G_CURREDITOR._config.defaultShowLockIconUserMode;a.getAttribute("show_icon")&&(e=a.getAttribute("show_icon"));a=document.getElementsByName("lock_icon_option");"0"==e?(a[1].checked=!0,a[0].checked=!1):(a[1].checked=
!1,a[0].checked=!0)}}
function applyTableLockProperty(){var a=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);a&&(document.getElementsByName("table_lock")[0].checked?(LayerWin.setClassName(a,"DEXT_five_table_lock"),a.setAttribute(DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,""),document.getElementsByName("lock_mode")[0].checked?a.setAttribute("lock_mode","1"):a.setAttribute("lock_mode","2"),document.getElementsByName("lock_icon_option")[0].checked?a.setAttribute("show_icon","1"):a.setAttribute("show_icon",
"0")):(LayerWin.removeLockAttr(a),LayerWin.removeClassName(a,"DEXT_five_table_lock"),a.removeAttribute("lock_mode"),a.removeAttribute("show_icon")),a=LayerWin.getFirstRange().range.startContainer,3==a.nodeType&&(a=a.parentNode),a&&1==a.nodeType&&LayerWin.setMenuIconRealable(a));event_dext_close()}
function setBorderListValue(a,b){switch(a){case "none":b.style.borderTopStyle="none";break;case "solid":b.style.borderTop="1px solid rgb(93, 93, 93)";break;case "dotted":b.style.borderTop="1px dotted rgb(93, 93, 93)";break;case "dashed":b.style.borderTop="1px dashed rgb(93, 93, 93)";break;case "double":b.style.border="3px double rgb(93, 93, 93)";break;case "groove":b.style.border="3px groove rgb(225, 225, 225)";break;case "ridge":b.style.border="3px ridge rgb(225, 225, 225)";break;case "inset":b.style.border=
"3px inset rgb(225, 225, 225)";break;case "outset":b.style.border="3px outset rgb(225, 225, 225)"}}
function paste_to_image_loaded_event(){var a=LayerWin._dext_editor._config.style.skinName;document.getElementById("dext_dialog_box").className="DEXT_fiVe_ED_Popup_Type06 DEXT_fiVe_PUi_"+a;var a=document.getElementById("html_btn"),b=document.getElementById("image_width"),c=document.getElementById("image_height"),e=document.getElementById("image_quality");document.getElementById("span_title").innerHTML=LayerWin.dext5_lang.paste_to_image.title;document.getElementById("span_save_client").innerHTML=LayerWin.dext5_lang.paste_to_image.save_client;
document.getElementById("legent_format").innerHTML=LayerWin.dext5_lang.paste_to_image.format;document.getElementById("label_quality").innerHTML=LayerWin.dext5_lang.paste_to_image.quality;document.getElementById("rotate").innerHTML=LayerWin.dext5_lang.paste_to_image.rotate;document.getElementById("size").innerHTML=LayerWin.dext5_lang.paste_to_image.size;document.getElementById("label_width").innerHTML=LayerWin.dext5_lang.paste_to_image.width;document.getElementById("label_height").innerHTML=LayerWin.dext5_lang.paste_to_image.height;
document.getElementById("lock_size_rate").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_size_rate;document.getElementById("span_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.origin_size;document.getElementById("dt_preview").innerHTML=LayerWin.dext5_lang.paste_to_image.preview;document.getElementById("label_lock_size_rate").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_size_rate;document.getElementById("label_lock_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_origin_size;
""!=LayerWin._dext_editor._config.buttonText001?document.getElementById("span_insert_image").innerHTML=LayerWin._dext_editor._config.buttonText001:document.getElementById("span_insert_image").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_image;document.getElementById("span_insert_html").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_html;DEXTTOP.DEXT5.util.addEvent(e,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(e,"blur",function(){100<DEXTTOP.DEXT5.util.parseIntOr0(e.value)?
e.value="100":0==DEXTTOP.DEXT5.util.parseIntOr0(e.value)&&(e.value="1")});DEXTTOP.DEXT5.util.addEvent(b,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(c,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(p,10)*parseInt(b.value,10)/parseInt(n,10);c.value=isNaN(a)?c.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(c,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=
parseInt(n,10)*parseInt(c.value,10)/parseInt(p,10);b.value=isNaN(a)?b.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(document.getElementById("span_origin_size").parentNode,"click",function(){b.value=n;c.value=p});DEXTTOP.DEXT5.util.addEvent(document.getElementById("lock_origin_size"),"click",function(){document.getElementById("lock_origin_size").checked?(b.value=n,c.value=p,b.disabled=!0,c.disabled=!0):(b.disabled=!1,c.disabled=!1)});DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinUp"),
"click",function(){0==e.disabled&&LayerWin.click_plus_func(document.getElementById("image_quality"),100,10)});DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinDown"),"click",function(){0==e.disabled&&LayerWin.click_minus_func(document.getElementById("image_quality"),1,10)});var d=document.getElementById("canvas_preview"),f=d.getContext("2d"),g=window.URL||window.webkitURL||window,h=g.createObjectURL(DEXTTOP.G_CURREDITOR.clipImageBlob),l=new Image,k,m,n,p,v=0,z=0,x=1;imageType="jpeg";
var w={type:"",width:0,height:0,checkOriginSize:!1};0==DEXTTOP.G_CURREDITOR.bTextorHtmlData&&(document.getElementById("html_btn").style.display="none",a=document.getElementById("image_btn"));DEXTTOP.DEXT5.util.addEvent(document.getElementById("image_btn"),"click",function(){for(var a=0,g=document.getElementsByName("image_rotate"),h=g.length,k=0;k<h;k++)if(g[k].checked){a=DEXTTOP.DEXT5.util.parseIntOr0(g[k].value);break}g=1;0==e.disabled&&(g=1*DEXTTOP.DEXT5.util.parseIntOr0(e.value)/100);var m=function(a){a&&
(DEXTTOP.G_CURREDITOR.clipImageBlob=a);w.type="image";w.width=DEXTTOP.DEXT5.util.parseIntOr0(b.value);w.height=DEXTTOP.DEXT5.util.parseIntOr0(c.value);w.checkOriginSize=document.getElementById("lock_origin_size").checked;LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,w);l=void 0;event_dext_close()};0!=a||1!=g||"png"!=imageType?(d.style.display="none",90==a||270==a?(h=l.height,k=l.width):(h=l.width,k=l.height),d.width=h,d.height=k,f.save(),f.translate(d.width/2,d.height/
2),f.rotate(a*Math.PI/180),f.clearRect(0,0,d.width,d.height),f.drawImage(l,-l.width/2,-l.height/2,l.width,l.height),f.restore(),d.toBlob(function(a){m(a)},"image/"+imageType,g)):m()});DEXTTOP.DEXT5.util.addEvent(document.getElementById("html_btn"),"click",function(){w.type="html";LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,w);l=void 0;event_dext_close()});for(var A=document.getElementsByName("image_rotate"),B=A.length,y=0;y<B;y++){var q=function(a){return function(e){e=
DEXTTOP.DEXT5.util.parseIntOr0(A[a].value);f.save();f.clearRect(0,0,d.width,d.height);f.translate(d.width/2,d.height/2);f.rotate(e*Math.PI/180);f.drawImage(l,-k/2,-m/2,k,m);f.restore();var g;90==e||270==e?(e=l.height,g=l.width,n=l.height,p=l.width):(e=l.width,g=l.height,n=l.width,p=l.height);b.value=e;c.value=g}}(y);DEXTTOP.DEXT5.util.addEvent(A[y],"click",q)}for(var r=document.getElementsByName("image_type"),B=r.length,y=0;y<B;y++)q=function(a){return function(b){b=r[a].value;"jpg"==b?(imageType=
"jpeg",e.disabled=!1):(imageType=b,e.disabled=!0)}}(y),DEXTTOP.DEXT5.util.addEvent(r[y],"click",q);e.value="100";setCursorPos(document.getElementById("image_type_jpg"),!1,!1);LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_jpg"),a);(function(a){l.onload=function(){n=l.width;p=l.height;b.value=l.width;c.value=l.height;x=Math.min(d.width/l.width,d.height/l.height);1>x?(k=Math.round(l.width*x),m=Math.round(l.height*x)):(k=l.width,m=l.height,x=1);k<d.width&&(v=(d.width-k)/2);
m<d.height&&(z=(d.height-m)/2);f.drawImage(l,v,z,k,m);try{g.revokeObjectURL(a)}catch(e){}};l.src=a})(h)}function dext_create_conversion(){var a={text:document.getElementById("targetContent").value};LayerWin.event_dext_create_conversion(a,window.frameElement.parentNode.parentNode)}function dext_calculator(){var a=document.getElementById("valueText");LayerWin.event_dext_calculator(a.value,window.frameElement.parentNode.parentNode)}DEXTTOP.DEXT5.util.addEvent(window,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});
DEXTTOP.DEXT5.util.addEvent(document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(window,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});
