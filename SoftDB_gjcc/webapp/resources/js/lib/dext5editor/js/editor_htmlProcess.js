var G_processHtmlWorker;
function fn_processHtmlWorker(a){var c=!1;_iframeDoc&&"true"==_iframeDoc.body.contentEditable&&(_iframeDoc.body.contentEditable="false",c=!0);G_processHtmlWorker=new Worker(a.editorConfig.htmlProcessWorkerJSUrl+"?ver="+DEXTTOP.DEXT5.ReleaseVer);try{G_processHtmlWorker.onmessage=function(b){var d="",d=b.data.errorMessage?a.callFnParam[0]:b.data.htmlResult;releaseProcessHtmlWorker();1==c&&(_iframeDoc.body.contentEditable="true");a&&a.callBackFn&&("SetCorrectOfficeHtml"==a.callFn?a.callBackFn(d,void 0,
b.data.wordProcessorType):a.callBackFn(d))},G_processHtmlWorker.onerror=function(b){releaseProcessHtmlWorker();1==c&&(_iframeDoc.body.contentEditable="true");a&&a.callBackFn&&a.callBackFn(a.callFnParam[0])},G_processHtmlWorker.postMessage({editorBrowser:a.editorBrowser,editorConfig:a.editorConfig,callFn:a.callFn,callFnParam:a.callFnParam})}catch(e){releaseProcessHtmlWorker(),a&&a.callBackFn&&a.callBackFn(a.callFnParam[0])}}
function releaseProcessHtmlWorker(){if("undefined"!=typeof G_processHtmlWorker)try{G_processHtmlWorker.terminate()}catch(a){}}function destoryWebWorkerVar(){if("undefined"!=typeof G_processHtmlWorker)try{G_processHtmlWorker=null,delete G_processHtmlWorker}catch(a){}};
